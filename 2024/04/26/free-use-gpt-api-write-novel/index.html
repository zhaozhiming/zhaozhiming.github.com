<!DOCTYPE HTML>
<html>
<head>
	<meta charset="utf-8">
    
	<title>ç”¨ API æ–¹å¼å…è´¹ä½¿ç”¨ GPT å†™å°è¯´ - Hacker and Geeker&#39;s Way</title>
    <meta name="author" content="">
    
	<meta name="description" content="ä»‹ç»å¦‚ä½•ä»¥ API çš„æ–¹å¼å…è´¹ä½¿ç”¨ OpenAI çš„ GPT3.5 æ¨¡å‹å†™å°è¯´"> <!-- TODO: truncate -->
	<meta name="keywords" content="gpt, llm, chatgpt">
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

	<link href="atom.xml" rel="alternate" title="Hacker and Geeker&#39;s Way" type="application/atom+xml">
	<link href="/favicon.ico" rel="shortcut icon">
    <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
    <link href="/stylesheets/custom.css" media="screen, projection" rel="stylesheet" type="text/css">
    <link href="/stylesheets/hljs.css" media="screen, projection" rel="stylesheet" type="text/css">

    <link href='/stylesheets/font.css?family=Slackey' rel='stylesheet' type='text/css'>
    <link href='/stylesheets/font.css?family=Fjalla+One' rel='stylesheet' type='text/css'>
    <link href='/stylesheets/font.css?family=Amethysta+One' rel='stylesheet' type='text/css'>
	  <script src="/javascripts/jquery.min.js"></script>
    <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![}]-->

    <script type="text/javascript" src="/javascripts/jquery-tapir.js"></script>

    <!-- remove or comment it to disable ajaxification -->   
    <!-- <script src="/javascripts/ajaxify.js"></script> -->

    

    
	<script type="text/javascript">
		var _gaq = _gaq || [];
		_gaq.push(['_setAccount', 'UA-100485541-1']);
		_gaq.push(['_trackPageview']);

		(function() {
			var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
			ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
			var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
		})();
	</script>


<meta name="generator" content="Hexo 6.3.0"></head>


<body>
    <div id="wrapper">
    <header id="header" class="inner"><!-- for more effects see _animate.scss -->
<h1 class="animated bounceInDown">
    <div id="headerbg">
        Hacker and Geeker&#39;s Way
    </div>
</h1>
<span class="subtitle"></span>
<br>

<ul id="social-links" style="text-align:center; clear:both;">
  
  <!-- GitHub -->
  <li>
  <a target="_blank" rel="noopener" href="https://github.com/zhaozhiming" class="github" title="Github"></a>
  </li>
  
  
  
  
  <!-- Twitter -->
  <li>
  <a target="_blank" rel="noopener" href="http://www.twitter.com/kingzzm" class="twitter" title="Twitter"></a>
  </li>
  
  
  <!-- LinkedIn -->
  <li>
  <a target="_blank" rel="noopener" href="http://www.linkedin.com/in/zhaozhiming" class="linkedin" title="LinkedIn"></a>
  </li>
  
  
  
  
  
  <!-- Stackoverflow -->
  <li>
  <a target="_blank" rel="noopener" href="http://stackoverflow.com/users/1954315/zhaozhiming" class="stackoverflow" title="Stackoverflow"></a>
  </li>
  
</ul>


<!-- use full url including 'index.html' for navigation bar if you are using ajax -->
<ul id="nav">
	<li id="ajax"><a href="/index.html">Home</a></li>
	<li id="ajax"><a href="/archives/index.html">Archives</a></li>
    <li><a href="/atom.xml">RSS</a></li>
    <li><a href="/about/index.html">About</a></li>
    
    <li>
    <div id="dark">
        <form action="//www.google.com.hk/search" method="get" accept-charset="UTF-8" id="search">
            <input type="hidden" name="sitesearch" value="https://zhaozhiming.github.io" />
            <input type="text" name="q" results="0" placeholder="Search..." x-webkit-speech />
        </form>
    </div>
    </li>
        
</ul>




</header>


<div id="toload">
<!-- begin toload -->
    <div id="content">
        <div class="inner">
<article class="post">
	<h2 class="title">ç”¨ API æ–¹å¼å…è´¹ä½¿ç”¨ GPT å†™å°è¯´</h2>
    <div class="meta">
        <div class="date">Published on: <time datetime="2024-04-26T06:32:39.000Z" itemprop="datePublished">4æœˆ 26, 2024</time>
</div>
        <div class="tags">Tags: 

<a href="/tags/chatgpt/">chatgpt</a> <a href="/tags/llm/">llm</a> <a href="/tags/gpt/">gpt</a>
</div>
    </div>
	<div class="entry-content"><img src="/images/post/2024/04/free-gpt.jpeg" class="" width="400" height="300">

<p>æœ€è¿‘ OpenAI å®£å¸ƒå°†é™ä½ç½‘é¡µç‰ˆ ChatGPT çš„ä½¿ç”¨é—¨æ§›ï¼Œå…è®¸æ²¡æœ‰è´¦å·çš„ç”¨æˆ·ä½¿ç”¨ï¼Œè¿™ä¸€å¥½æ¶ˆæ¯ä½¿æˆ‘ä»¬å¯ä»¥åœ¨ç½‘é¡µä¸Šå…è´¹è®¿é—® ChatGPTï¼Œä½†å’Œ API ç›¸æ¯”ä»ç„¶ç¼ºä¹çµæ´»æ€§ï¼Œé€šè¿‡ API å¼€å‘äººå‘˜å¯ä»¥ç¼–å†™ä»£ç æ¥ä¸ ChatGPT è¿›è¡Œè‡ªåŠ¨åŒ–äº¤äº’ã€‚ä»Šå¤©æˆ‘ä»¬å°†ä»‹ç»å¦‚ä½•åˆ©ç”¨ OpenAI çš„è¿™ä¸€å…è´¹åŠŸèƒ½ï¼Œå°†å…¶è½¬åŒ–ä¸º API çš„å½¢å¼æ¥è¿›è¡Œä½¿ç”¨ï¼Œå¹¶ä»‹ç»å¦‚ä½•é€šè¿‡è¿™ç§æ–¹å¼æ¥å†™ä¸€ç¯‡å°è¯´ã€‚</p>
<span id="more"></span>

<h2 id="ChatGPT"><a href="#ChatGPT" class="headerlink" title="ChatGPT"></a>ChatGPT</h2><p>æœ€è¿‘ä¸€æ®µæ—¶é—´ï¼ŒOpenAI å®£å¸ƒç”¨æˆ·æ— éœ€æ³¨å†Œå³å¯ä½¿ç”¨ ChatGPTï¼Œå…è´¹ä½¿ç”¨çš„æ¨¡å‹æ˜¯ GPT3.5ï¼Œè¿™æ˜¯ä¸€ä¸ªéå¸¸å¼ºå¤§çš„ LLMï¼ˆå¤§è¯­è¨€æ¨¡å‹ï¼‰ï¼Œå¤„ç†æ—¥å¸¸å·¥ä½œçš„å¤§å¤šæ•°ä»»åŠ¡éƒ½ä¸åœ¨è¯ä¸‹ã€‚ä½†æ˜¯æ²¡æœ‰æ³¨å†Œçš„ç”¨æˆ·æ— æ³•äº«å—æ›´å¤šåŠŸèƒ½ï¼ŒåŒ…æ‹¬ä¿å­˜å’ŒæŸ¥çœ‹èŠå¤©è®°å½•ã€å…±äº«èŠå¤©å’Œè§£é”å…¶ä»–åŠŸèƒ½ï¼Œå¦‚è¯­éŸ³å¯¹è¯å’Œè‡ªå®šä¹‰æŒ‡ä»¤ç­‰ï¼Œæ›´å¤šçš„ä¿¡æ¯å¯ä»¥æŸ¥çœ‹<a target="_blank" rel="noopener" href="https://openai.com/blog/start-using-chatgpt-instantly">è¿™é‡Œ</a>ã€‚</p>
<img src="/images/post/2024/04/use-gpt-without-signup.png" class="" width="1000" height="600">

<h2 id="ä»¥-API-æ–¹å¼ä½¿ç”¨"><a href="#ä»¥-API-æ–¹å¼ä½¿ç”¨" class="headerlink" title="ä»¥ API æ–¹å¼ä½¿ç”¨"></a>ä»¥ API æ–¹å¼ä½¿ç”¨</h2><p>è™½ç„¶ OpenAI æä¾›äº†å…è´¹ç‰ˆçš„ç½‘é¡µ ChatGPTï¼Œä½†å¦‚æœèƒ½ç”¨ API çš„æ–¹å¼æ¥è°ƒç”¨ ChatGPT å°†ä¼šæ›´åŠ æ–¹ä¾¿ï¼Œæˆ‘ä»¬å¯ä»¥åšçš„äº‹æƒ…ä¹Ÿä¼šæ›´å¤šã€‚å¼€æºç¤¾åŒºå°±æœ‰è¿™ä¹ˆä¸€ä¸ªå·¥å…·ï¼Œå¯ä»¥å°†ç½‘é¡µç‰ˆ ChatGPT è½¬åŒ–ä¸º API çš„å½¢å¼ï¼Œè¿™ä¸ªå·¥å…·å«åš <a target="_blank" rel="noopener" href="https://github.com/PawanOsman/ChatGPT">ChatGPT</a>ï¼Œè¯¥å·¥å…·é€šè¿‡åå‘ä»£ç†çš„æ–¹å¼æ¥å…è´¹è®¿é—® ChatGPT APIï¼Œæ”¯æŒæœ¬åœ°éƒ¨ç½²ï¼Œæ— éœ€æä¾› OpenAI çš„ APIKEYã€‚</p>
<p>è¯¥å·¥å…·çš„å®‰è£…éå¸¸ç®€å•ï¼Œæä¾›äº† 2 ç§å®‰è£…æ–¹å¼ï¼š</p>
<h3 id="docker-å®‰è£…"><a href="#docker-å®‰è£…" class="headerlink" title="docker å®‰è£…"></a>docker å®‰è£…</h3><p>åœ¨æœ¬åœ°æå‰å®‰è£…å¥½ <a target="_blank" rel="noopener" href="https://docs.docker.com/engine/install/">Docker</a>ï¼Œç„¶åæ‰§è¡Œä»¥ä¸‹å‘½ä»¤å³å¯å¯åŠ¨æœåŠ¡ï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -dp 3040:3040 pawanosman/chatgpt:latest</span><br></pre></td></tr></table></figure>

<h3 id="æºç å®‰è£…"><a href="#æºç å®‰è£…" class="headerlink" title="æºç å®‰è£…"></a>æºç å®‰è£…</h3><p>åœ¨æœ¬åœ°æå‰å®‰è£…å¥½<a target="_blank" rel="noopener" href="https://nodejs.org/en/download">NodeJs</a>ï¼Œä¸‹è½½æºç ï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">clone</span> git <span class="built_in">clone</span> https://github.com/PawanOsman/ChatGPT.git</span><br></pre></td></tr></table></figure>

<p>ç„¶åè¿›å…¥ç›®å½•ï¼Œæ‰§è¡Œå¯åŠ¨è„šæœ¬<code>bash start.sh</code>å³å¯å¯åŠ¨æœåŠ¡ã€‚</p>
<h3 id="ä½¿ç”¨"><a href="#ä½¿ç”¨" class="headerlink" title="ä½¿ç”¨"></a>ä½¿ç”¨</h3><p>æœ¬åœ°æœåŠ¡çš„åœ°å€æ˜¯ï¼š<code>http://localhost:3040</code>ï¼Œå¯ä»¥é€šè¿‡ curl å‘½ä»¤æ¥è°ƒç”¨ APIï¼Œä¾‹å¦‚ï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">curl http://localhost:3040/v1/chat/completions \</span><br><span class="line">  -H <span class="string">&quot;Content-Type: application/json&quot;</span> \</span><br><span class="line">  -d <span class="string">&#x27;&#123;</span></span><br><span class="line"><span class="string">    &quot;messages&quot;: [</span></span><br><span class="line"><span class="string">      &#123;</span></span><br><span class="line"><span class="string">        &quot;role&quot;: &quot;user&quot;,</span></span><br><span class="line"><span class="string">        &quot;content&quot;: &quot;Hello!&quot;</span></span><br><span class="line"><span class="string">      &#125;</span></span><br><span class="line"><span class="string">    ]</span></span><br><span class="line"><span class="string">  &#125;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ˜¾ç¤ºç»“æœ</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">&quot;id&quot;</span>: <span class="string">&quot;chatcmpl-SKCmI8iJ2cPswvySaCSKX55n8viL&quot;</span>,</span><br><span class="line">  <span class="string">&quot;created&quot;</span>: 1714120019,</span><br><span class="line">  <span class="string">&quot;model&quot;</span>: <span class="string">&quot;gpt-3.5-turbo&quot;</span>,</span><br><span class="line">  <span class="string">&quot;object&quot;</span>: <span class="string">&quot;chat.completion&quot;</span>,</span><br><span class="line">  <span class="string">&quot;choices&quot;</span>: [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="string">&quot;finish_reason&quot;</span>: <span class="string">&quot;stop&quot;</span>,</span><br><span class="line">      <span class="string">&quot;index&quot;</span>: 0,</span><br><span class="line">      <span class="string">&quot;message&quot;</span>: &#123;</span><br><span class="line">        <span class="string">&quot;content&quot;</span>: <span class="string">&quot;Hi there! How can I assist you today?&quot;</span>,</span><br><span class="line">        <span class="string">&quot;role&quot;</span>: <span class="string">&quot;assistant&quot;</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  ],</span><br><span class="line">  <span class="string">&quot;usage&quot;</span>: &#123;</span><br><span class="line">    <span class="string">&quot;prompt_tokens&quot;</span>: 2,</span><br><span class="line">    <span class="string">&quot;completion_tokens&quot;</span>: 10,</span><br><span class="line">    <span class="string">&quot;total_tokens&quot;</span>: 12</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>åœ¨ curl å‘½ä»¤ä¸­ï¼Œæˆ‘ä»¬æ²¡æœ‰æä¾› OpenAI çš„ APIKEY ä¹Ÿèƒ½æ­£å¸¸è°ƒç”¨ ChatGPT APIï¼Œè¿”å›çš„ç»“æœä¹Ÿæ˜¯å’ŒçœŸæ­£çš„ ChatGPT API ä¸€è‡´ã€‚</p>
<h3 id="æ³¨æ„äº‹é¡¹"><a href="#æ³¨æ„äº‹é¡¹" class="headerlink" title="æ³¨æ„äº‹é¡¹"></a>æ³¨æ„äº‹é¡¹</h3><p>å› ä¸º ChatGPT çš„ä½¿ç”¨æœ‰åœ°åŒºé™åˆ¶ï¼Œå¦‚æœä½ æ‰€åœ¨åœ°åŒºæ— æ³•è®¿é—® OpenAI çš„æœåŠ¡ï¼Œé‚£ä¹ˆåœ¨è°ƒç”¨æ¥å£æ—¶æœ¬åœ°æœåŠ¡ä¼šæç¤ºä»¥ä¸‹é”™è¯¯ä¿¡æ¯ï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Error getting a new session...</span><br><span class="line">If this error persists, your country may not be supported yet.</span><br><span class="line">If your country was the issue, please consider using a U.S. VPN or a U.S. residential proxy.</span><br></pre></td></tr></table></figure>

<p>å»ºè®®æ˜¯æ‰¾ä¸€å°å¯ä»¥è®¿é—® OpenAI æœåŠ¡çš„æœåŠ¡å™¨ï¼Œæœ€å¥½æ˜¯ç¾å›½åœ°åŒºçš„æœåŠ¡å™¨ï¼Œåœ¨ä¸Šé¢éƒ¨ç½²æœåŠ¡ã€‚</p>
<h2 id="ä½¿ç”¨-ChatGPT-å†™å°è¯´"><a href="#ä½¿ç”¨-ChatGPT-å†™å°è¯´" class="headerlink" title="ä½¿ç”¨ ChatGPT å†™å°è¯´"></a>ä½¿ç”¨ ChatGPT å†™å°è¯´</h2><p>æœ‰äº†å…è´¹çš„ ChatGPT API åï¼Œæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨ ChatGPT æ¥åšå¾ˆå¤šäº‹æƒ…äº†ï¼ŒAI ç°åœ¨æœ€æ“…é•¿çš„æ˜¯æ–‡å­—ç”Ÿæˆï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ ChatGPT æ¥å†™å°è¯´ã€‚</p>
<p>è¿™é‡Œä»‹ç»å¦å¤–ä¸€ä¸ªå¼€æºé¡¹ç›® <a target="_blank" rel="noopener" href="https://github.com/mshumer/gpt-author">gpt-author</a>ï¼Œå®ƒæä¾›äº†ä¸€ç³»åˆ—çš„æç¤ºè¯æ¥å¸®åŠ©æˆ‘ä»¬å®Œæˆä¸€éƒ¨å°è¯´ï¼Œå¹¶ä¸”å¯ä»¥ç»“åˆ Stable Diffustion æ¥ç”Ÿæˆå°è¯´å°é¢ã€‚å¤šç§ LLM æ¨¡å‹å¯ä¾›é€‰æ‹©ï¼Œå¯ä»¥ä½¿ç”¨ OpenAI çš„ GPT æ¨¡å‹ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ Anthropic çš„ Claude æ¨¡å‹ã€‚å¦‚æœæƒ³ç”Ÿæˆçš„å°è¯´æ•ˆæœè¶Šå¥½ï¼Œé‚£ä¹ˆè‚¯å®šéœ€è¦èƒ½åŠ›è¶Šå¼ºçš„æ¨¡å‹ï¼Œæ¯”å¦‚ GPT4 æˆ–è€… Claudeï¼Œä½†è¿™äº›æ¨¡å‹ç›®å‰éƒ½éœ€è¦æ”¶è´¹ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å…ˆä½¿ç”¨æˆ‘ä»¬ä¹‹å‰æ­å»ºçš„å…è´¹ ChatGPT API æ¥è¯•è¯•æ•ˆæœã€‚</p>
<p>gpt-author çš„ä»“åº“ä¸»è¦æ˜¯ä¸€ä¸ª ipynb æ–‡ä»¶ï¼Œé‡Œé¢åŒ…å«äº†å¦‚ä½•ä½¿ç”¨ ChatGPT æ¥å†™å°è¯´çš„ä»£ç ï¼Œå¯ä»¥ç›´æ¥åœ¨æœ¬åœ°è¿è¡Œï¼Œä¹Ÿå¯ä»¥åœ¨ Google Colab ä¸Šè¿è¡Œï¼Œä¸‹é¢æˆ‘ä»¬æ¥çœ‹ä¸‹é‡Œé¢çš„ä»£ç å¹¶ä»‹ç»å…¶ä½œç”¨ã€‚</p>
<p>ä»£ç ä¸­åŒ…å«äº†å¦‚ä½•ä½¿ç”¨ Anthropic çš„ APIï¼Œä½†æˆ‘ä»¬åªéœ€è¦è°ƒç”¨æˆ‘ä»¬éƒ¨ç½²çš„ ChatGPT API å³å¯ï¼Œæ‰€ä»¥æ¶‰åŠåˆ° Anuthropic çš„ä»£ç è¿™é‡Œå°±ä¸åšä»‹ç»ã€‚</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> openai</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">from</span> ebooklib <span class="keyword">import</span> epub</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">openai.api_key = <span class="string">&quot;YOUR OPENAI KEY&quot;</span> <span class="comment"># You can enter any string here</span></span><br><span class="line">openai.api_base = <span class="string">&quot;http://localhost:3040/v1&quot;</span></span><br><span class="line">stability_api_key = <span class="string">&quot;YOUR STABILITY KEY&quot;</span> <span class="comment"># get it at https://beta.dreamstudio.ai/</span></span><br></pre></td></tr></table></figure>

<ul>
<li>å¦‚æœæ˜¯åœ¨æœ¬åœ°è¿è¡Œï¼Œéœ€è¦æå‰å®‰è£…ç›¸å…³çš„ python åº“ï¼š<code>pip install openai ebooklib requests</code></li>
<li><code>openai.api_key</code> è¿™é‡Œå¯ä»¥éšä¾¿å¡«å†™ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå› ä¸ºæˆ‘ä»¬çš„ ChatGPT API ä¸éœ€è¦ APIKEY</li>
<li><code>openai.api_base</code> è¿™é‡Œå¡«å†™æˆ‘ä»¬éƒ¨ç½²çš„ ChatGPT API åœ°å€ï¼Œå¦‚æœæ˜¯åœ¨æœ¬åœ°è¿è¡Œï¼Œå¡«å†™<code>http://localhost:3040/v1</code>ï¼Œæ³¨æ„ä¸è¦é—æ¼åœ°å€æœ€åçš„<code>/v1</code></li>
<li><code>stability_api_key</code> è¿™é‡Œæ˜¯ Stability Diffusion çš„ APIKEYï¼Œç”¨æ¥ç”Ÿæˆå°è¯´å°é¢çš„ï¼Œå¦‚æœä¸éœ€è¦ç”Ÿæˆå°é¢ï¼Œå¯ä»¥ä¸å¡«å†™</li>
</ul>
<p>è®¾ç½®å¥½ API æœåŠ¡å‚æ•°åï¼Œæˆ‘ä»¬å†æ¥çœ‹å…¶ä¸­çš„å†™å°è¯´çš„ä¸»æ–¹æ³•<code>write_fantasy_novel</code>ï¼š</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> ast</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">write_fantasy_novel</span>(<span class="params">prompt, num_chapters, writing_style, claude_true=<span class="literal">False</span></span>):</span><br><span class="line">    plots = generate_plots(prompt)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;generated plots&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    best_plot = select_most_engaging(plots)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;selected best plot&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    improved_plot = improve_plot(best_plot)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;plot improved&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    title = get_title(improved_plot)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;title generated&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    storyline = generate_storyline(improved_plot, num_chapters)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;storyline generated&#x27;</span>)</span><br><span class="line">    chapter_titles = ast.literal_eval(storyline)</span><br><span class="line">    novel = <span class="string">f&quot;Storyline:\n<span class="subst">&#123;storyline&#125;</span>\n\n&quot;</span></span><br><span class="line"></span><br><span class="line">    first_chapter = write_first_chapter(storyline, chapter_titles[<span class="number">0</span>], writing_style.strip(), claude_true)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;first chapter written&#x27;</span>)</span><br><span class="line">    novel += <span class="string">f&quot;Chapter 1:\n<span class="subst">&#123;first_chapter&#125;</span>\n&quot;</span></span><br><span class="line">    chapters = [first_chapter]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(num_chapters - <span class="number">1</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;Writing chapter <span class="subst">&#123;i+<span class="number">2</span>&#125;</span>...&quot;</span>) <span class="comment"># + 2 because the first chapter was already added</span></span><br><span class="line"></span><br><span class="line">        chapter = write_chapter(novel, storyline, chapter_titles[i+<span class="number">1</span>])</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">          <span class="keyword">if</span> <span class="built_in">len</span>(<span class="built_in">str</span>(chapter)) &lt; <span class="number">100</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;Length minimum not hit. Trying again.&#x27;</span>)</span><br><span class="line">            chapter = write_chapter(novel, storyline, chapter_titles[i+<span class="number">1</span>])</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">          chapter = write_chapter(novel, storyline, chapter_titles[i+<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line">        novel += <span class="string">f&quot;Chapter <span class="subst">&#123;i+<span class="number">2</span>&#125;</span>:\n<span class="subst">&#123;chapter&#125;</span>\n&quot;</span></span><br><span class="line">        chapters.append(chapter)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> novel, title, chapters, chapter_titles</span><br></pre></td></tr></table></figure>

<ul>
<li>è¿™ä¸ªæ–¹æ³•ç½—åˆ—äº†ç¼–å†™å°è¯´çš„ä¸»è¦æ­¥éª¤ï¼Œæ–¹æ³•å‚æ•°æœ‰æç¤ºè¯ã€ç« èŠ‚æ•°ã€å†™ä½œé£æ ¼ï¼Œæœ€åé‚£ä¸ªæ˜¯å¦ä½¿ç”¨ Claude æ¨¡å‹çš„å‚æ•°æˆ‘ä»¬å¯ä»¥å¿½ç•¥</li>
<li>é¦–å…ˆæ˜¯ç”Ÿæˆå¤šä¸ªå°è¯´æƒ…èŠ‚</li>
<li>ç„¶åä»è¿™äº›å°è¯´æƒ…èŠ‚ä¸­é€‰æ‹©æœ€å¸å¼•äººçš„æƒ…èŠ‚</li>
<li>å†å¯¹é€‰æ‹©çš„æƒ…èŠ‚è¿›è¡Œæ”¹è¿›</li>
<li>æ ¹æ®æœ€ç²¾å½©çš„æƒ…èŠ‚ç”Ÿæˆå°è¯´æ ‡é¢˜</li>
<li>æ¥ä¸‹æ¥ç”Ÿæˆå°è¯´çš„æ•…äº‹çº¿ï¼Œå¹¶å°†å…¶è½¬æ¢æˆ Python æ•°ç»„ï¼Œå½¢æˆç« èŠ‚æ ‡é¢˜</li>
<li>ä½¿ç”¨ç¬¬ä¸€ä¸ªç« èŠ‚æ ‡é¢˜å†™å°è¯´ç¬¬ä¸€ç« çš„å†…å®¹</li>
<li>åˆ›å»º<code>novel</code>å¯¹è±¡ä¿å­˜å°è¯´å†…å®¹ï¼Œåˆ›å»º<code>chapters</code>æ•°ç»„æ¥ä¿å­˜æ¯ä¸€ç« çš„å†…å®¹</li>
<li>ç”Ÿæˆæ¯ä¸€ç« èŠ‚çš„å†…å®¹ï¼Œå¦‚æœç« èŠ‚çš„å†…å®¹è¾ƒå°‘ï¼ˆå°äº 100ï¼‰åˆ™é‡æ–°ç”Ÿæˆ</li>
<li>æœ€åå°†æ¯ä¸€ç« çš„å†…å®¹æ·»åŠ åˆ°<code>novel</code>å’Œ<code>chapters</code>å¯¹è±¡ä¸­</li>
</ul>
<p>æˆ‘ä»¬å†çœ‹ç”Ÿæˆå°è¯´ç« èŠ‚çš„æ–¹æ³•<code>generate_plots</code>ï¼š</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> openai</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">generate_plots</span>(<span class="params">prompt</span>):</span><br><span class="line">    response = openai.ChatCompletion.create(</span><br><span class="line">        model=<span class="string">&quot;gpt-4&quot;</span>,</span><br><span class="line">        messages=[</span><br><span class="line">            &#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;system&quot;</span>, <span class="string">&quot;content&quot;</span>: <span class="string">&quot;You are a creative assistant that generates engaging fantasy novel plots.&quot;</span>&#125;,</span><br><span class="line">            &#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;user&quot;</span>, <span class="string">&quot;content&quot;</span>: <span class="string">f&quot;Generate 10 fantasy novel plots based on this prompt: <span class="subst">&#123;prompt&#125;</span>&quot;</span>&#125;</span><br><span class="line">        ]</span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line">    print_step_costs(response, <span class="string">&quot;gpt-4&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> response[<span class="string">&#x27;choices&#x27;</span>][<span class="number">0</span>][<span class="string">&#x27;message&#x27;</span>][<span class="string">&#x27;content&#x27;</span>].split(<span class="string">&#x27;\n&#x27;</span>)</span><br></pre></td></tr></table></figure>

<ul>
<li>è°ƒç”¨ ChatGPT API ç”Ÿæˆ 10 ä¸ªå°è¯´æƒ…èŠ‚</li>
<li>è¿™é‡Œçš„ model å‚æ•°å³ä½¿å¡«<code>gpt-4</code>ä¹Ÿæ²¡æœ‰å…³ç³»ï¼Œæˆ‘ä»¬çš„ API æœåŠ¡å§‹ç»ˆåªèƒ½è°ƒç”¨ GPT3.5 æ¨¡å‹</li>
<li><code>print_step_costs</code>æ–¹æ³•æ˜¯è®¡ç®— API çš„èŠ±è´¹é‡‘é¢ï¼Œå› ä¸ºæˆ‘ä»¬æ˜¯ç”¨å…è´¹çš„ ChatGPT API æœåŠ¡ï¼Œæ‰€ä»¥è¿™é‡Œä¸ç”¨å…³å¿ƒè´¹ç”¨</li>
</ul>
<p>æ¥ä¸‹æ¥æ˜¯é€‰æ‹©æœ€å¸å¼•äººçš„æƒ…èŠ‚çš„æ–¹æ³•<code>select_most_engaging</code>ï¼š</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">select_most_engaging</span>(<span class="params">plots</span>):</span><br><span class="line">    response = openai.ChatCompletion.create(</span><br><span class="line">        model=<span class="string">&quot;gpt-4&quot;</span>,</span><br><span class="line">        messages=[</span><br><span class="line">            &#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;system&quot;</span>, <span class="string">&quot;content&quot;</span>: <span class="string">&quot;You are an expert in writing fantastic fantasy novel plots.&quot;</span>&#125;,</span><br><span class="line">            &#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;user&quot;</span>, <span class="string">&quot;content&quot;</span>: <span class="string">f&quot;Here are a number of possible plots for a new novel: <span class="subst">&#123;plots&#125;</span>\n\n--\n\nNow, write the final plot that we will go with. It can be one of these, a mix of the best elements of multiple, or something completely new and better. The most important thing is the plot should be fantastic, unique, and engaging.&quot;</span>&#125;</span><br><span class="line">        ]</span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line">    print_step_costs(response, <span class="string">&quot;gpt-4&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> response[<span class="string">&#x27;choices&#x27;</span>][<span class="number">0</span>][<span class="string">&#x27;message&#x27;</span>][<span class="string">&#x27;content&#x27;</span>]</span><br></pre></td></tr></table></figure>

<ul>
<li>è°ƒç”¨ ChatGPT API ï¼Œæ ¹æ®æˆ‘ä»¬åˆšæ‰ç”Ÿæˆçš„ 10 ä¸ªå°è¯´æƒ…èŠ‚ï¼Œç”Ÿæˆæœ€å¸å¼•äººçš„æƒ…èŠ‚</li>
<li>ç”Ÿæˆçš„å†…å®¹å¯ä»¥æ˜¯ 10 ä¸ªæƒ…èŠ‚ä¸­çš„ä¸€ä¸ªï¼Œä¹Ÿå¯ä»¥æ˜¯å¤šä¸ªæƒ…èŠ‚çš„ç»„åˆï¼Œæˆ–è€…æ˜¯ä¸€ä¸ªå…¨æ–°çš„æƒ…èŠ‚</li>
</ul>
<p>æ¥ä¸‹æ¥æ˜¯æ”¹è¿›æƒ…èŠ‚çš„æ–¹æ³•<code>improve_plot</code>å’Œç”Ÿæˆå°è¯´æ ‡é¢˜çš„æ–¹æ³•<code>get_title</code>ï¼Œä»£ç åŠŸèƒ½åŸºæœ¬å’Œå‰é¢çš„æ–¹æ³•ä¸€è‡´ï¼Œæˆ‘ä»¬ä¸»è¦çœ‹æ–¹æ³•å†…éƒ¨çš„æç¤ºè¯ï¼š</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">improve_plot</span>(<span class="params">plot</span>):</span><br><span class="line">    response = openai.ChatCompletion.create(</span><br><span class="line">        model=<span class="string">&quot;gpt-4&quot;</span>,</span><br><span class="line">        messages=[</span><br><span class="line">            &#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;system&quot;</span>, <span class="string">&quot;content&quot;</span>: <span class="string">&quot;You are an expert in improving and refining story plots.&quot;</span>&#125;,</span><br><span class="line">            &#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;user&quot;</span>, <span class="string">&quot;content&quot;</span>: <span class="string">f&quot;Improve this plot: <span class="subst">&#123;plot&#125;</span>&quot;</span>&#125;</span><br><span class="line">        ]</span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line">    print_step_costs(response, <span class="string">&quot;gpt-4&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> response[<span class="string">&#x27;choices&#x27;</span>][<span class="number">0</span>][<span class="string">&#x27;message&#x27;</span>][<span class="string">&#x27;content&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_title</span>(<span class="params">plot</span>):</span><br><span class="line">    response = openai.ChatCompletion.create(</span><br><span class="line">        model=<span class="string">&quot;gpt-3.5-turbo-16k&quot;</span>,</span><br><span class="line">        messages=[</span><br><span class="line">            &#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;system&quot;</span>, <span class="string">&quot;content&quot;</span>: <span class="string">&quot;You are an expert writer.&quot;</span>&#125;,</span><br><span class="line">            &#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;user&quot;</span>, <span class="string">&quot;content&quot;</span>: <span class="string">f&quot;Here is the plot: <span class="subst">&#123;plot&#125;</span>\n\nWhat is the title of this book? Just respond with the title, do nothing else.&quot;</span>&#125;</span><br><span class="line">        ]</span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line">    print_step_costs(response, <span class="string">&quot;gpt-3.5-turbo-16k&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> response[<span class="string">&#x27;choices&#x27;</span>][<span class="number">0</span>][<span class="string">&#x27;message&#x27;</span>][<span class="string">&#x27;content&#x27;</span>]</span><br></pre></td></tr></table></figure>

<ul>
<li>è¿™é‡Œæœ‰ä¸ªæç¤ºè¯å°æŠ€å·§ï¼Œå°±æ˜¯è®© LLM åªå›ç­”æˆ‘ä»¬æƒ³è¦çš„å†…å®¹è€Œä¸è¦è¾“å‡ºå…¶ä»–å†…å®¹ï¼Œè¿™é‡Œçš„æç¤ºè¯è¦æ±‚ LLM åªå›ç­”æ ‡é¢˜ï¼Œä¸è¦åšå…¶ä»–æ“ä½œï¼Œè¿™æ ·å°±ä¸ä¼šæœ‰é¢å¤–çš„å†…å®¹å¹²æ‰°</li>
</ul>
<p>æ¥ç€æ˜¯ç”Ÿæˆå°è¯´æ•…äº‹çº¿çš„æ–¹æ³•<code>generate_storyline</code>ï¼š</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">generate_storyline</span>(<span class="params">prompt, num_chapters</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Generating storyline with chapters and high-level details...&quot;</span>)</span><br><span class="line">    json_format = <span class="string">&quot;&quot;&quot;[&#123;&quot;Chapter CHAPTER_NUMBER_HERE - CHAPTER_TITLE_GOES_HERE&quot;: &quot;CHAPTER_OVERVIEW_AND_DETAILS_GOES_HERE&quot;&#125;, ...]&quot;&quot;&quot;</span></span><br><span class="line">    response = openai.ChatCompletion.create(</span><br><span class="line">        model=<span class="string">&quot;gpt-4&quot;</span>,</span><br><span class="line">        messages=[</span><br><span class="line">            &#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;system&quot;</span>, <span class="string">&quot;content&quot;</span>: <span class="string">&quot;You are a world-class fantasy writer. Your job is to write a detailed storyline, complete with chapters, for a fantasy novel. Don&#x27;t be flowery -- you want to get the message across in as few words as possible. But those words should contain lots of information.&quot;</span>&#125;,</span><br><span class="line">            &#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;user&quot;</span>, <span class="string">&quot;content&quot;</span>: <span class="string">f&#x27;Write a fantastic storyline with <span class="subst">&#123;num_chapters&#125;</span> chapters and high-level details based on this plot: <span class="subst">&#123;prompt&#125;</span>.\n\nDo it in this list of dictionaries format <span class="subst">&#123;json_format&#125;</span>&#x27;</span>&#125;</span><br><span class="line">        ]</span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line">    print_step_costs(response, <span class="string">&quot;gpt-4&quot;</span>)</span><br><span class="line">    improved_response = openai.ChatCompletion.create(</span><br><span class="line">        model=<span class="string">&quot;gpt-4&quot;</span>,</span><br><span class="line">        messages=[</span><br><span class="line">            &#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;system&quot;</span>, <span class="string">&quot;content&quot;</span>: <span class="string">&quot;You are a world-class fantasy writer. Your job is to take your student&#x27;s rough initial draft of the storyline of a fantasy novel, and rewrite it to be significantly better.&quot;</span>&#125;,</span><br><span class="line">            &#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;user&quot;</span>, <span class="string">&quot;content&quot;</span>: <span class="string">f&quot;Here is the draft storyline they wrote: <span class="subst">&#123;response[<span class="string">&#x27;choices&#x27;</span>][<span class="number">0</span>][<span class="string">&#x27;message&#x27;</span>][<span class="string">&#x27;content&#x27;</span>]&#125;</span>\n\nNow, rewrite the storyline, in a way that is far superior to your student&#x27;s version. It should have the same number of chapters, but it should be much improved in as many ways as possible. Remember to do it in this list of dictionaries format <span class="subst">&#123;json_format&#125;</span>&quot;</span>&#125;</span><br><span class="line">        ]</span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line">    print_step_costs(improved_response, <span class="string">&quot;gpt-4&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> improved_response[<span class="string">&#x27;choices&#x27;</span>][<span class="number">0</span>][<span class="string">&#x27;message&#x27;</span>][<span class="string">&#x27;content&#x27;</span>]</span><br></pre></td></tr></table></figure>

<ul>
<li>åœ¨ç”Ÿæˆæ•…äº‹çº¿çš„æ–¹æ³•ä¸­ï¼Œç”Ÿæˆäº† 2 ä¸ªç‰ˆæœ¬çš„æ•…äº‹çº¿ï¼Œç¬¬ä¸€ä¸ªç‰ˆæœ¬æ˜¯åˆç¨¿ï¼Œç¬¬äºŒä¸ªç‰ˆæœ¬æ˜¯åœ¨ç¬¬ä¸€ç‰ˆçš„åŸºç¡€ä¸Šè¿›è¡Œæ”¹è¿›</li>
<li>è¿™é‡Œä¹Ÿæœ‰ä¸€ä¸ªæç¤ºè¯æŠ€å·§ï¼Œå°±æ˜¯è®© LLM è¿”å›æˆ‘ä»¬æƒ³è¦çš„æ ¼å¼ï¼Œè¿™é‡Œçš„æç¤ºè¯è¦æ±‚ LLM è¿”å› JSON æ ¼å¼çš„å†…å®¹ï¼Œè¿™æ ·åé¢æ‰å¯ä»¥å°†å…¶è½¬æ¢æˆ Python æ•°ç»„</li>
</ul>
<p>å†æ¥æ˜¯ç”Ÿæˆå°è¯´ç« èŠ‚çš„æ–¹æ³•<code>write_chapter</code>ï¼š</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">write_chapter</span>(<span class="params">previous_chapters, plot, chapter_title, claude=<span class="literal">True</span></span>):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        response = openai.ChatCompletion.create(</span><br><span class="line">            model=<span class="string">&quot;gpt-4&quot;</span>,</span><br><span class="line">            messages=[</span><br><span class="line">                &#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;system&quot;</span>, <span class="string">&quot;content&quot;</span>: <span class="string">&quot;You are a world-class fantasy writer.&quot;</span>&#125;,</span><br><span class="line">                &#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;user&quot;</span>, <span class="string">&quot;content&quot;</span>: <span class="string">f&quot;Plot: <span class="subst">&#123;plot&#125;</span>, Previous Chapters: <span class="subst">&#123;previous_chapters&#125;</span>\n\n--\n\nWrite the next chapter of this novel, following the plot and taking in the previous chapters as context. Here is the plan for this chapter: <span class="subst">&#123;chapter_title&#125;</span>\n\nWrite it beautifully. Include only the chapter text. There is no need to rewrite the chapter name.&quot;</span>&#125;</span><br><span class="line">            ]</span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line">        print_step_costs(response, <span class="string">&quot;gpt-4&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> response[<span class="string">&#x27;choices&#x27;</span>][<span class="number">0</span>][<span class="string">&#x27;message&#x27;</span>][<span class="string">&#x27;content&#x27;</span>]</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        response = openai.ChatCompletion.create(</span><br><span class="line">            model=<span class="string">&quot;gpt-4-32k&quot;</span>,</span><br><span class="line">            messages=[</span><br><span class="line">                &#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;system&quot;</span>, <span class="string">&quot;content&quot;</span>: <span class="string">&quot;You are a world-class fantasy writer.&quot;</span>&#125;,</span><br><span class="line">                &#123;<span class="string">&quot;role&quot;</span>: <span class="string">&quot;user&quot;</span>, <span class="string">&quot;content&quot;</span>: <span class="string">f&quot;Plot: <span class="subst">&#123;plot&#125;</span>, Previous Chapters: <span class="subst">&#123;previous_chapters&#125;</span>\n\n--\n\nWrite the next chapter of this novel, following the plot and taking in the previous chapters as context. Here is the plan for this chapter: <span class="subst">&#123;chapter_title&#125;</span>\n\nWrite it beautifully. Include only the chapter text. There is no need to rewrite the chapter name.&quot;</span>&#125;</span><br><span class="line">            ]</span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line">        print_step_costs(response, <span class="string">&quot;gpt-4-32k&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> response[<span class="string">&#x27;choices&#x27;</span>][<span class="number">0</span>][<span class="string">&#x27;message&#x27;</span>][<span class="string">&#x27;content&#x27;</span>]</span><br></pre></td></tr></table></figure>

<ul>
<li>æ–¹æ³•çš„ç¬¬äºŒä¸ªå‚æ•°<code>plot</code>å®é™…ä¸Šæ˜¯æˆ‘ä»¬ä¹‹å‰ç”Ÿæˆçš„æ•…äº‹çº¿ï¼Œè¡¨ç¤ºè¿™ä¸ªç« èŠ‚çš„å†…å®¹è¦åŸºäºè¿™ä¸ªæ•…äº‹çº¿æ¥ç”Ÿæˆ</li>
<li>æç¤ºè¯ä¸­è¿˜åŠ å…¥äº†ä¹‹å‰çš„ç« èŠ‚å†…å®¹ï¼Œè¿™æ ·å¯ä»¥è®© LLM æ›´å¥½çš„ç†è§£æ•´ä¸ªå°è¯´çš„å†…å®¹</li>
<li>è¿™é‡Œé¦–å…ˆä½¿ç”¨<code>gpt-4</code>æ¨¡å‹è¿›è¡Œç”Ÿæˆï¼Œ<code>gpt-4</code>æ¨¡å‹é»˜è®¤æ˜¯<code>8K</code>çš„ä¸Šä¸‹æ–‡ï¼Œå¦‚æœç”Ÿæˆçš„å†…å®¹è¾ƒå¤šè¶…å‡ºä¸Šä¸‹æ–‡é™åˆ¶å°±ä¼šæŠ¥é”™ï¼Œæ•è·å¼‚å¸¸åå†æ¬¡ä½¿ç”¨<code>gpt-4-32k</code>æ¨¡å‹è¿›è¡Œç”Ÿæˆï¼Œæœ€æ–°çš„<code>gpt-4-turbo</code>æ¨¡å‹æ˜¯<code>128k</code>ï¼Œå¤§å®¶å¯ä»¥æ ¹æ®è‡ªå·±çš„éœ€æ±‚æ¥é€‰æ‹©æ¨¡å‹ã€‚æˆ‘ä»¬ä½¿ç”¨çš„æ˜¯å…è´¹çš„ ChatGPT APIï¼Œæ¨¡å‹æ˜¯<code>gpt-3.5-turbo</code>ï¼Œä¸Šä¸‹æ–‡é•¿åº¦æ˜¯<code>16k</code></li>
</ul>
<p>æœ€åæ˜¯æ•´ä½“çš„è°ƒç”¨æ–¹æ³•ï¼š</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Example usage:</span></span><br><span class="line">prompt = <span class="string">&quot;A kingdom hidden deep in the forest, where every tree is a portal to another world.&quot;</span></span><br><span class="line">num_chapters = <span class="number">10</span></span><br><span class="line">writing_style = <span class="string">&quot;Clear and easily understandable, similar to a young adult novel. Lots of dialogue.&quot;</span></span><br><span class="line">novel, title, chapters, chapter_titles = write_fantasy_novel(prompt, num_chapters, writing_style, claude_true)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Replace chapter descriptions with body text in chapter_titles</span></span><br><span class="line"><span class="keyword">for</span> i, chapter <span class="keyword">in</span> <span class="built_in">enumerate</span>(chapters):</span><br><span class="line">    chapter_number_and_title = <span class="built_in">list</span>(chapter_titles[i].keys())[<span class="number">0</span>]</span><br><span class="line">    chapter_titles[i] = &#123;chapter_number_and_title: chapter&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># Create the cover</span></span><br><span class="line">create_cover_image(<span class="built_in">str</span>(chapter_titles))</span><br><span class="line"></span><br><span class="line"><span class="comment"># Create the EPUB file</span></span><br><span class="line">create_epub(title, <span class="string">&#x27;AI&#x27;</span>, chapter_titles, <span class="string">&#x27;/content/cover.png&#x27;</span>)</span><br></pre></td></tr></table></figure>

<ul>
<li><code>prompt</code>æè¿°æƒ³è¦åˆ›å»ºä»€ä¹ˆå†…å®¹çš„å°è¯´ï¼Œ<code>num_chapters</code>å°è¯´çš„ç« èŠ‚æ•°ï¼Œ<code>writing_style</code>å†™ä½œé£æ ¼</li>
<li>å°†ç« èŠ‚æ ‡é¢˜å’Œå†…å®¹ç»„åˆæˆä¸€ä¸ªå¯¹è±¡<code>chapter_titles</code></li>
<li><code>create_cover_image</code>æ–¹æ³•æ˜¯ä½¿ç”¨ Stability Diffusion ç”Ÿæˆå°è¯´å°é¢ï¼Œç”Ÿæˆåçš„å°é¢å›¾ç‰‡ä¼šä¿å­˜åˆ°<code>/content/cover.png</code>æ–‡ä»¶ä¸­ï¼Œä½ ä¹Ÿå¯ä»¥ç›´æ¥å°†å›¾ç‰‡æ”¾åˆ°<code>/content/cover.png</code>æ–‡ä»¶ä¸­ï¼Œè¿™æ ·å°±ä¸éœ€è¦è°ƒç”¨è¿™ä¸ªæ–¹æ³•äº†</li>
<li><code>create_epub</code>æ–¹æ³•æ˜¯ç”Ÿæˆ EPUB æ ¼å¼çš„å°è¯´æ–‡ä»¶ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯å°è¯´çš„æ ‡é¢˜ï¼Œç¬¬äºŒä¸ªæ˜¯ä½œè€…ï¼Œç¬¬ä¸‰ä¸ªæ˜¯å°è¯´å†…å®¹ï¼Œç¬¬å››ä¸ªå‚æ•°æ˜¯å°é¢å›¾ç‰‡</li>
</ul>
<p>è¿™å°±æ˜¯<code>gpt-author</code>è¿™ä¸ªé¡¹ç›®çš„ä¸»è¦ä»£ç ï¼Œå¦‚æœæƒ³äº†è§£å®ƒçš„å…¶ä»–ä»£ç å¯ä»¥æŸ¥çœ‹å®ƒçš„ GitHub ä»“åº“ã€‚ç†è§£ä½¿ç”¨ AI ç”Ÿæˆå°è¯´çš„æ€è·¯ä»¥åï¼Œä½ ä¹Ÿå¯ä»¥æ ¹æ®è‡ªå·±çš„éœ€æ±‚æ¥è°ƒæ•´ä»£ç ï¼Œæ¯”å¦‚è°ƒæ•´ç”Ÿæˆå°è¯´çš„ç« èŠ‚æ•°ã€å†™ä½œé£æ ¼ç­‰ï¼Œç„¶åå°è¯•è‡ªå·±ç”Ÿæˆä¸€éƒ¨å°è¯´ã€‚</p>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>ä»Šå¤©æˆ‘ä»¬ä»‹ç»äº†å¦‚ä½•ä»¥ API çš„æ–¹å¼å…è´¹ä½¿ç”¨ OpenAI çš„ ChatGPT æ¨¡å‹ï¼Œä»¥åŠå¦‚ä½•ä½¿ç”¨ ChatGPT æ¥å†™ä¸€éƒ¨å°è¯´ã€‚å¯èƒ½ç”¨å…è´¹çš„ ChatGPT æ¨¡å‹ç”Ÿæˆçš„å°è¯´è¿˜ä¸å¤Ÿå®Œç¾ï¼Œä½†å¯ä»¥é€šè¿‡ä¼˜åŒ–è°ƒæ•´ç›¸å…³çš„æç¤ºè¯ï¼Œè®©å…¶ç”Ÿæˆçš„å°è¯´æ›´åŠ ç¬¦åˆæˆ‘ä»¬çš„éœ€æ±‚ã€‚åŒæ ·åœ°ï¼Œä¹Ÿå¯ä»¥å°†å…¶ä¸­çš„æç¤ºè¯æ–¹æ³•åº”ç”¨åˆ°ç¼–å†™å…¶ä»–ç±»å‹çš„æ–‡ç« ä¸­ï¼ŒæœŸå¾…å¤§å®¶èƒ½å¤Ÿå°è¯•å¹¶ç”Ÿæˆä¸€äº›æœ‰è¶£çš„å†…å®¹ã€‚</p>
<p>å…³æ³¨æˆ‘ï¼Œä¸€èµ·å­¦ä¹ å„ç§äººå·¥æ™ºèƒ½å’Œ AIGC æ–°æŠ€æœ¯ï¼Œæ¬¢è¿äº¤æµï¼Œå¦‚æœä½ æœ‰ä»€ä¹ˆæƒ³é—®æƒ³è¯´çš„ï¼Œæ¬¢è¿åœ¨è¯„è®ºåŒºç•™è¨€ã€‚</p>
</div>

</article>
<section id="appreciates">
  <center>
	<h2>èµèµ</h2>
    <div class="post-footer">
      <div>
	    <h4>å¦‚æœæ–‡ç« å¯¹æ‚¨æœ‰æ‰€å¸®åŠ©ï¼Œå¯ä»¥æèµ æˆ‘å–æ¯å’–å•¡ğŸ˜Œï¼Œæèµ æ–¹å¼ï¼š</h4>
        <div class="digital-wallet">
          <h6>BTC åœ°å€ï¼š3LYgSyf7ddMALwGWPQr3PY4wzjsTDdg1oV</h6>
          <h6>ETH åœ°å€ï¼š0x0C9b27c89A61aadb0aEC24CA8949910Cbf77Aa73</h6>
        </div>
        <div class="wechat_appreciates">
          <img src="/images/wechat_appreciates.png" alt="qrcode" width="250" >
        </div>
      </div>
      <div>
	    <h4>æ–‡ç« å·²åŒæ­¥æ›´æ–°å…¬ä¼—å·ï¼Œæ¬¢è¿å…³æ³¨</h4>
        <div class="wechat_appreciates">
          <img src="/images/wxgzh_qrcode.jpg" alt="qrcode" width="250" >
        </div>
      </div>
    </div>
  </center>
</section>



    
      <script type="text/javascript">
        var disqus_config = function () {
            this.page.url = 'https://zhaozhiming.github.io/2024/04/26/free-use-gpt-api-write-novel/';
            this.page.identifier = 'https://zhaozhiming.github.io/2024/04/26/free-use-gpt-api-write-novel/';
        };

        (function() {
          var d = document, s = d.createElement('script');
          s.src = '//zhaozhiming.disqus.com/embed.js';
          s.setAttribute('data-timestamp', +new Date());
          (d.head || d.body).appendChild(s);
        })();
      </script>
    



<section id="comment">
    <h2 class="title">Comments</h2>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a target="_blank" rel="noopener" href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
</section>

</div>

    </div>
    <footer id="footer">
    <div style="display:inline">
    Copyright &copy; 2025

    èµµèŠæ˜
. Powered by <a href="http://zespia.tw/hexo/" target="_blank">Hexo</a> |
    Theme is <a target="_blank" rel="noopener" href="https://github.com/wd/hexo-fabric">hexo-fabric</a>, fork from <a target="_blank" rel="noopener" href="http://github.com/panks/fabric">fabric</a> by <a target="_blank" rel="noopener" href="http://panks.me">Pankaj Kumar</a>
</div>


    </footer>
    <script src="/javascripts/fabric.js"></script>
<script src="/javascripts/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
	$('.fancybox').fancybox();
})(jQuery);
</script>
 <!-- Delete or comment this line to disable Fancybox -->



<!-- end toload --> 
</div>
</div>
<script src="/javascripts/jquery.ui.totop.js" type="text/javascript"></script>
<script type="text/javascript">
/*<![CDATA[*/
;(function($){$().UItoTop({easingType:'easeOutCirc'});})(jQuery); 
/*]]>*/
</script><!-- remove it to remove the scroll to top button -->
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5608723650603289" crossorigin="anonymous"></script>
</body>
</html>
