<!DOCTYPE HTML>
<html>
<head>
	<meta charset="utf-8">
    
	<title>å¯¹ Llama3 æ‰§è¡ŒåŸºå‡†æµ‹è¯•è¯„ä¼° - Hacker and Geeker&#39;s Way</title>
    <meta name="author" content="">
    
	<meta name="description" content="ä»‹ç» LLM çš„è¯„æµ‹æŒ‡æ ‡åŠå¦‚ä½•ä½¿ç”¨è¯„æµ‹ Llama3"> <!-- TODO: truncate -->
	<meta name="keywords" content="llm, opencompass, llama3">
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

	<link href="atom.xml" rel="alternate" title="Hacker and Geeker&#39;s Way" type="application/atom+xml">
	<link href="/favicon.ico" rel="shortcut icon">
    <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
    <link href="/stylesheets/custom.css" media="screen, projection" rel="stylesheet" type="text/css">
    <link href="/stylesheets/hljs.css" media="screen, projection" rel="stylesheet" type="text/css">

    <link href='/stylesheets/font.css?family=Slackey' rel='stylesheet' type='text/css'>
    <link href='/stylesheets/font.css?family=Fjalla+One' rel='stylesheet' type='text/css'>
    <link href='/stylesheets/font.css?family=Amethysta+One' rel='stylesheet' type='text/css'>
	  <script src="/javascripts/jquery.min.js"></script>
    <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![}]-->

    <script type="text/javascript" src="/javascripts/jquery-tapir.js"></script>

    <!-- remove or comment it to disable ajaxification -->   
    <!-- <script src="/javascripts/ajaxify.js"></script> -->

    

    
	<script type="text/javascript">
		var _gaq = _gaq || [];
		_gaq.push(['_setAccount', 'UA-100485541-1']);
		_gaq.push(['_trackPageview']);

		(function() {
			var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
			ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
			var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
		})();
	</script>


<meta name="generator" content="Hexo 6.3.0"></head>


<body>
    <div id="wrapper">
    <header id="header" class="inner"><!-- for more effects see _animate.scss -->
<h1 class="animated bounceInDown">
    <div id="headerbg">
        Hacker and Geeker&#39;s Way
    </div>
</h1>
<span class="subtitle"></span>
<br>

<ul id="social-links" style="text-align:center; clear:both;">
  
  <!-- GitHub -->
  <li>
  <a target="_blank" rel="noopener" href="https://github.com/zhaozhiming" class="github" title="Github"></a>
  </li>
  
  
  
  
  <!-- Twitter -->
  <li>
  <a target="_blank" rel="noopener" href="http://www.twitter.com/kingzzm" class="twitter" title="Twitter"></a>
  </li>
  
  
  <!-- LinkedIn -->
  <li>
  <a target="_blank" rel="noopener" href="http://www.linkedin.com/in/zhaozhiming" class="linkedin" title="LinkedIn"></a>
  </li>
  
  
  
  
  
  <!-- Stackoverflow -->
  <li>
  <a target="_blank" rel="noopener" href="http://stackoverflow.com/users/1954315/zhaozhiming" class="stackoverflow" title="Stackoverflow"></a>
  </li>
  
</ul>


<!-- use full url including 'index.html' for navigation bar if you are using ajax -->
<ul id="nav">
	<li id="ajax"><a href="/index.html">Home</a></li>
	<li id="ajax"><a href="/archives/index.html">Archives</a></li>
    <li><a href="/atom.xml">RSS</a></li>
    <li><a href="/about/index.html">About</a></li>
    
    <li>
    <div id="dark">
        <form action="//www.google.com.hk/search" method="get" accept-charset="UTF-8" id="search">
            <input type="hidden" name="sitesearch" value="https://zhaozhiming.github.io" />
            <input type="text" name="q" results="0" placeholder="Search..." x-webkit-speech />
        </form>
    </div>
    </li>
        
</ul>




</header>


<div id="toload">
<!-- begin toload -->
    <div id="content">
        <div class="inner">
<article class="post">
	<h2 class="title">å¯¹ Llama3 æ‰§è¡ŒåŸºå‡†æµ‹è¯•è¯„ä¼°</h2>
    <div class="meta">
        <div class="date">Published on: <time datetime="2024-04-29T08:49:27.000Z" itemprop="datePublished">4æœˆ 29, 2024</time>
</div>
        <div class="tags">Tags: 

<a href="/tags/llm/">llm</a> <a href="/tags/llama3/">llama3</a> <a href="/tags/opencompass/">opencompass</a>
</div>
    </div>
	<div class="entry-content"><img src="/images/post/2024/05/llama3-evaluation.jpg" class="" width="400" height="300">

<p>è¿‘æ—¥ Meta æ¨å‡ºä»–ä»¬æœ€æ–°çš„å¼€æº LLMï¼ˆå¤§è¯­è¨€æ¨¡å‹ï¼‰Llama3ï¼Œå¸å¼•äº†ä¼—å¤šç§‘æŠ€é¢†åŸŸä¸šå†…äººå£«çš„å…³æ³¨ã€‚Meta åŒæ—¶ä¹Ÿå…¬å¸ƒäº† Llama3 çš„å„é¡¹åŸºå‡†æµ‹è¯•æŒ‡æ ‡ï¼ŒLlama3 åœ¨å„é¡¹æŒ‡æ ‡çš„å¾—åˆ†ä¸Šè¡¨ç°ä¼˜å¼‚ï¼Œè¶…è¿‡äº†ç›®å‰å¸‚é¢ä¸Šå…¶ä»–å¼€æº LLMã€‚ä»Šå¤©æˆ‘ä»¬å°±æ¥èŠèŠ LLM çš„åŸºå‡†æµ‹è¯•æŒ‡æ ‡ï¼Œä»¥åŠå¦‚ä½•ä½¿ç”¨å·¥å…·æ¥è¯„æµ‹ Llama3ã€‚</p>
<span id="more"></span>

<h2 id="LLama3-ä»‹ç»"><a href="#LLama3-ä»‹ç»" class="headerlink" title="LLama3 ä»‹ç»"></a>LLama3 ä»‹ç»</h2><p>Llama3 çš„å‘å¸ƒæ— ç–‘æ˜¯äººå·¥æ™ºèƒ½é¢†åŸŸçš„ä¸€ä¸ªé‡ç£…æ¶ˆæ¯ï¼Œåœ¨ Meta çš„å®˜æ–¹ä»‹ç»ä¸­ç½—åˆ—äº† Llama3 çš„æ¨¡å‹èƒ½åŠ›ã€è®­ç»ƒå‚æ•°ç­‰æŠ€æœ¯ä¿¡æ¯ï¼Œæœ‰ç½‘å‹å¯¹è¿™æ¬¡å‘å¸ƒè¿›è¡Œäº†æ€»ç»“ï¼š</p>
<img src="/images/post/2024/05/llama3-features.jpeg" class="" width="1000" height="600">

<p>Llama3 å¼€æ”¾äº† 8B å’Œ 70B ä¸¤ç§å‚æ•°çš„ LLMï¼Œå„é¡¹èƒ½åŠ›æ¯” Llama2 å¼ºå¾ˆå¤šï¼ŒåŒæ—¶è¿˜æœ‰ä¸€ä¸ª 400B çš„ LLM è¿˜åœ¨è®­ç»ƒä¸­ã€‚</p>
<h3 id="æ¨¡å‹ä¸‹è½½"><a href="#æ¨¡å‹ä¸‹è½½" class="headerlink" title="æ¨¡å‹ä¸‹è½½"></a>æ¨¡å‹ä¸‹è½½</h3><p>Llama3 å¯ä»¥åœ¨ HuggingFace ä¸Šè¿›è¡Œä¸‹è½½ï¼Œä½†åœ¨ä¸‹è½½ä¹‹å‰éœ€è¦å…ˆæäº¤ç”³è¯·ï¼ŒHuggingFace ä¸Šçš„ç”³è¯·é¡µé¢å¦‚ä¸‹ï¼š</p>
<img src="/images/post/2024/05/llama3-application.png" class="" width="1000" height="600">

<p>ç”³è¯·åå¤§çº¦ç­‰å¾… 1 ä¸ªå°æ—¶å°±å®¡æ‰¹é€šè¿‡äº†ï¼Œæ¥ç€å¯ä»¥ä½¿ç”¨ HuggingFace çš„ CLI å‘½ä»¤è¿›è¡Œä¸‹è½½ï¼Œéœ€è¦åœ¨ç»ˆç«¯è¿›è¡Œç™»å½•å†ä¸‹è½½ï¼Œä»¥ä¸‹è½½ Llama3-8B ä¸ºä¾‹ï¼Œå‘½ä»¤å¦‚ä¸‹ï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">huggingface-cli login</span><br><span class="line"><span class="comment"># è¾“å…¥ HuggingFace è´¦å·çš„ access token</span></span><br><span class="line">huggingface-cli download meta-llama/Meta-Llama-3-8B</span><br></pre></td></tr></table></figure>

<p>æˆ–è€…ç›´æ¥ä¸‹è½½ä½†éœ€è¦å¸¦ä¸Š HuggingFace çš„ tokenï¼Œå‘½ä»¤å¦‚ä¸‹ï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">huggingface-cli download meta-llama/Meta-Llama-3-8B --token YOUR_TOKEN</span><br></pre></td></tr></table></figure>

<h2 id="LLM-åŸºå‡†æµ‹è¯•"><a href="#LLM-åŸºå‡†æµ‹è¯•" class="headerlink" title="LLM åŸºå‡†æµ‹è¯•"></a>LLM åŸºå‡†æµ‹è¯•</h2><p>LLM åŸºå‡†æµ‹è¯•å°±åƒæ˜¯ LLM çš„<strong>è€ƒè¯•</strong>ï¼Œè¿™ä¸ªè€ƒè¯•ä¼šç”¨ä¸€ç³»åˆ—çš„æ•°æ®é›†ã€é—®é¢˜å’Œä»»åŠ¡æ¥è€ƒéªŒæ¨¡å‹çš„èªæ˜ç¨‹åº¦ï¼Œç„¶åæ ¹æ®æ¨¡å‹çš„è¡¨ç°ç»™å‡ºä¸€ä¸ªåˆ†æ•°ï¼Œæ»¡åˆ†æ˜¯ 100 åˆ†ã€‚LLM åŸºå‡†æµ‹è¯•ç»™äº†ä¸€ä¸ªç»Ÿä¸€çš„æ ‡å‡†æ¥è¡¡é‡ä¸åŒ LLM çš„æ€§èƒ½ï¼Œè¿™æ ·ä¸€æ¥ï¼Œä¸ç®¡æ˜¯å…¬å¸é‡Œçš„å†³ç­–è€…ã€äº§å“ç»ç†è¿˜æ˜¯å¼€å‘äººå‘˜ï¼Œéƒ½èƒ½æ›´å®¹æ˜“åœ°æ¯”è¾ƒå’Œé€‰æ‹©æœ€é€‚åˆä»–ä»¬éœ€æ±‚çš„æ¨¡å‹ï¼Œå¼€å‘è€…æ›´å¥½åœ°äº†è§£ LLM çš„é•¿å¤„å’ŒçŸ­æ¿ä¹‹åï¼Œå°±èƒ½é’ˆå¯¹æ€§åœ°æ”¹è¿›æ¨¡å‹ï¼Œè®©æ¨¡å‹å˜å¾—æ›´å¥½æ›´å¼ºå¤§ã€‚</p>
<p>LLM åŸºå‡†æµ‹è¯•åŒ…æ‹¬ä»¥ä¸‹æ–¹é¢ï¼š</p>
<ul>
<li>é€šç”¨èƒ½åŠ›ï¼šæŒ‡çš„æ˜¯æ¨¡å‹çš„è¯­è¨€ç†è§£ã€å¯¹è¯ç†è§£ç­‰èƒ½åŠ›ï¼Œå¸¸ç”¨çš„æµ‹è¯•æœ‰ MMLUã€MT-Bench ç­‰</li>
<li>Agent èƒ½åŠ›ï¼šåŒ…æ‹¬å·¥å…·è°ƒç”¨ã€è‡ªæˆ‘è°ƒè¯•ã€æ ¹æ®åé¦ˆä¿¡æ¯ã€æ¢ç´¢ç¯å¢ƒç­‰æ–¹é¢çš„èƒ½åŠ›</li>
<li>é€»è¾‘æ¨ç†ï¼šæŒ‡çš„æ˜¯æ¨¡å‹çš„æ•°å­¦ã€ç¼–ç ç­‰èƒ½åŠ›ï¼Œå¸¸ç”¨çš„æµ‹è¯•æœ‰ HumanEvalã€GSM8K ç­‰</li>
<li>é•¿æ–‡æœ¬èƒ½åŠ›ï¼šæŒ‡çš„æ˜¯æ¨¡å‹çš„é•¿æ–‡æœ¬æ€»ç»“ã€é—®ç­”ç­‰èƒ½åŠ›</li>
<li>ç‰¹å®šè‡ªç„¶è¯­è¨€å¤„ç†ä»»åŠ¡ï¼šåŒ…æ‹¬é˜…è¯»ç†è§£ã€å¸¸è¯†æ¨ç†ã€ä¸–ç•ŒçŸ¥è¯†ã€ç‰¹å®šé¢†åŸŸçŸ¥è¯†ç­‰æ–¹é¢çš„èƒ½åŠ›ï¼Œå¸¸ç”¨çš„æµ‹è¯•æœ‰ ARCã€HellaSwagã€SIQAã€WinoGrandeã€TruthfulQA ç­‰</li>
<li>çœŸå®é—®ç­”ï¼šæŒ‡çš„æ˜¯æ¨¡å‹ç”ŸæˆçœŸå®ç­”æ¡ˆçš„èƒ½åŠ›ï¼Œä¹Ÿæ˜¯å‡å°‘å¹»è§‰çš„èƒ½åŠ›</li>
</ul>
<p>ä¸‹é¢æ˜¯ Llama3 8B å’Œ 70B æ¨¡å‹çš„åŸºå‡†æµ‹è¯•å¾—åˆ†ï¼š</p>
<img src="/images/post/2024/05/llama3-benchmark.png" class="" width="1000" height="600">

<p>Meta ä½¿ç”¨äº† MMLUã€HumanEvalã€GSM8K ç­‰åŸºå‡†å¯¹ Llama3 8B å’Œ 70B çš„æ¨¡å‹è¿›è¡Œäº†è¯„æµ‹ï¼Œä»å›¾ä¸­å¯ä»¥çœ‹å‡ºï¼ŒLlama3 åœ¨å„é¡¹åŸºå‡†æµ‹è¯•ä¸­çš„å¾—åˆ†éƒ½å¾ˆé«˜ï¼Œå°¤å…¶æ˜¯ç¼–ç èƒ½åŠ›ï¼ŒHumanEval å’Œ GSM8K çš„å¾—åˆ†éƒ½æ¯”è¾ƒé«˜ã€‚</p>
<p>æˆ‘ä»¬å†çœ‹ä¸‹ OpenAI æ¨¡å‹åŸºå‡†æµ‹è¯•å¾—åˆ†ï¼š</p>
<img src="/images/post/2024/05/gpt-benchmark.png" class="" width="1000" height="600">

<p>OpenAI ä½¿ç”¨äº† MMLUã€HellaSwagã€WinoGrandeã€ARCã€HumanEval ç­‰åŸºå‡†å¯¹ GPT-3.5 å’Œ GPT-4 ç­‰æ¨¡å‹è¿›è¡Œäº†è¯„æµ‹ï¼Œä½†åœ¨ HumanEval ä¸Šçš„åˆ†æ•°æ¯” Llama3 ä½å¾ˆå¤šã€‚</p>
<p>åœ¨ <a target="_blank" rel="noopener" href="https://huggingface.co/collections/open-llm-leaderboard/the-big-benchmarks-collection-64faca6335a7fc7d4ffe974a">HuggingFace</a> ä¸Šï¼Œä¸€èˆ¬æ˜¯ä½¿ç”¨ ARCã€ HellaSwagã€MMLUã€TruthQAã€WinoGrande å’Œ GSM8K è¿™å‡ ä¸ªåŸºå‡†å¯¹ LLM è¿›è¡Œè¯„æµ‹ã€‚</p>
<img src="/images/post/2024/05/huggingface-benchmark.png" class="" width="1000" height="600">

<h2 id="ä½¿ç”¨-OpenCompass-è¯„æµ‹-Llama3"><a href="#ä½¿ç”¨-OpenCompass-è¯„æµ‹-Llama3" class="headerlink" title="ä½¿ç”¨ OpenCompass è¯„æµ‹ Llama3"></a>ä½¿ç”¨ OpenCompass è¯„æµ‹ Llama3</h2><h3 id="OpenCompass-ä»‹ç»"><a href="#OpenCompass-ä»‹ç»" class="headerlink" title="OpenCompass ä»‹ç»"></a>OpenCompass ä»‹ç»</h3><p><a target="_blank" rel="noopener" href="https://github.com/open-compass/OpenCompass/">OpenCompass</a> ä½œä¸ºä¸€ä¸ªä¸“ä¸šçš„å¤§æ¨¡å‹è¯„æµ‹å·¥å…·ï¼Œä¸ºç”¨æˆ·æä¾›äº†å…¨é¢ã€é«˜æ•ˆã€çµæ´»çš„è¯„æµ‹è§£å†³æ–¹æ¡ˆï¼Œé€šè¿‡å¼€æºå¯å¤ç°çš„è¯„æµ‹æ¡†æ¶ï¼Œæ”¯æŒå¯¹å„ç±»æ¨¡å‹è¿›è¡Œå…¨é¢çš„èƒ½åŠ›è¯„ä¼°ã€‚OpenCompass å°†æµ‹è¯„æ–¹å‘æ±‡æ€»ä¸ºçŸ¥è¯†ã€è¯­è¨€ã€ç†è§£ã€æ¨ç†ã€è€ƒè¯•ç­‰äº”å¤§èƒ½åŠ›ç»´åº¦ï¼Œæ•´åˆè¶…è¿‡ 70 ä¸ªè¯„æµ‹æ•°æ®é›†ï¼Œæä¾›è¶…è¿‡ 40 ä¸‡ä¸ªæ¨¡å‹è¯„æµ‹é—®é¢˜ï¼Œæ”¯æŒè¶…è¿‡ 70 ç§å¼€æºæ¨¡å‹çš„è¯„æµ‹ï¼ŒåŒ…æ‹¬æœ€æ–°çš„ Llama3 æ¨¡å‹ã€‚</p>
<h3 id="OpenCompass-å®‰è£…"><a href="#OpenCompass-å®‰è£…" class="headerlink" title="OpenCompass å®‰è£…"></a>OpenCompass å®‰è£…</h3><p>OpenCompass çš„å®‰è£…æ–¹å¼åˆ†ä¸º GPU ç¯å¢ƒå’Œ CPU ç¯å¢ƒï¼Œæˆ‘ä»¬ä»¥ GPU ç¯å¢ƒä¸ºä¾‹è¿›è¡Œè®²è§£ï¼Œé¦–å…ˆä½¿ç”¨<code>conda</code>åˆ›å»ºä¸€ä¸ªæ–°çš„ Python ç¯å¢ƒï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">conda create --name opencompass python=3.10 pytorch torchvision pytorch-cuda -c nvidia -c pytorch -y</span><br><span class="line">conda activate opencompass</span><br></pre></td></tr></table></figure>

<p>ç„¶åä¸‹è½½ OpenCompass çš„ä»£ç ä»“åº“å¹¶å®‰è£…ç›¸å…³ä¾èµ–ï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">clone</span> https://github.com/open-compass/opencompass.git</span><br><span class="line"><span class="built_in">cd</span> opencompass</span><br><span class="line">pip install -e .</span><br></pre></td></tr></table></figure>

<p>å› ä¸ºæˆ‘ä»¬åé¢è¿˜è¦åš HumanEval çš„è¯„æµ‹ï¼Œæ‰€ä»¥è¿˜éœ€è¦é¢å¤–å®‰è£… HumanEval ï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">clone</span> https://github.com/openai/human-eval.git</span><br><span class="line"><span class="built_in">cd</span> human-eval</span><br><span class="line">pip install -r requirements.txt</span><br><span class="line">pip install -e .</span><br><span class="line"><span class="built_in">cd</span> ..</span><br></pre></td></tr></table></figure>

<p>OpenCompass æä¾›äº†åŸºå‡†æµ‹è¯•çš„æ•°æ®é›†ï¼ŒåŒ…å« HuggingFace å’Œå…¶ä»–ç¬¬ä¸‰æ–¹çš„æ•°æ®é›†ï¼Œè¿˜æœ‰ OpenCompass è‡ªå·±çš„æ•°æ®é›†ï¼Œä¸‹è½½è¿™äº›æ•°æ®é›†å¹¶è§£å‹åˆ° OpenCompass çš„ç›®å½•ä¸‹ï¼Œè§£å‹å®Œæˆå OpenCompass ç›®å½•ä¸‹ä¼šå‡ºç°ä¸€ä¸ª data ç›®å½•ï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> opencompass</span><br><span class="line">wget https://github.com/open-compass/opencompass/releases/download/0.2.2.rc1/OpenCompassData-core-20240207.zip</span><br><span class="line">unzip OpenCompassData-core-20240207.zip</span><br><span class="line"><span class="built_in">rm</span> OpenCompassData-core-20240207.zip</span><br></pre></td></tr></table></figure>

<h3 id="Llama3-åŸºå‡†è¯„æµ‹"><a href="#Llama3-åŸºå‡†è¯„æµ‹" class="headerlink" title="Llama3 åŸºå‡†è¯„æµ‹"></a>Llama3 åŸºå‡†è¯„æµ‹</h3><p>åœ¨å¼€å§‹æµ‹è¯„ä¹‹å‰ï¼Œå…ˆä»‹ç»ä¸€ä¸‹ç¡¬ä»¶é…ç½®å’Œè¯„æµ‹æ¨¡å‹ï¼š</p>
<ul>
<li>ç¡¬ä»¶é…ç½®ï¼šNvidia 4090 24G æ˜¾å­˜</li>
<li>è¯„æµ‹æ¨¡å‹ï¼š<a target="_blank" rel="noopener" href="https://huggingface.co/meta-llama/Meta-Llama-3-8B-Instruct">Meta-Llama-3-8B-Instruct</a></li>
</ul>
<p>åŒæ—¶è®¾ç½®å¥½æµ‹è¯•æ—¶æ‰€éœ€çš„ç¯å¢ƒå˜é‡ï¼Œå¦‚æœä¸è®¾ç½®è¿è¡Œç¨‹åºä¼šæŠ¥é”™ï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">export</span> MKL_SERVICE_FORCE_INTEL=1</span><br><span class="line"><span class="built_in">export</span> MKL_THREADING_LAYER=GNU</span><br><span class="line"><span class="built_in">export</span> TF_ENABLE_ONEDNN_OPTS=0</span><br></pre></td></tr></table></figure>

<ul>
<li>MKL_SERVICE_FORCE_INTEL&#x3D;1: è¡¨ç¤ºåº”ç”¨ç¨‹åºåœ¨æ‰§è¡Œä½¿ç”¨è‹±ç‰¹å°”æ•°å­¦æ ¸å¿ƒåº“ï¼ˆMKLï¼‰çš„æ“ä½œæ—¶ï¼Œå¼ºåˆ¶ä½¿ç”¨è‹±ç‰¹å°”çš„æœåŠ¡å±‚ï¼Œå³ä½¿åœ¨éè‹±ç‰¹å°”çš„ç¡¬ä»¶ä¸Šä¹Ÿæ˜¯å¦‚æ­¤ã€‚</li>
<li>MKL_THREADING_LAYER&#x3D;GNU: æŒ‡å®š MKL ä½¿ç”¨çš„çº¿ç¨‹åº“ä¸º GNUï¼ˆGOMPï¼Œå³ GNU OpenMPï¼‰ï¼Œé€‰æ‹©æ­£ç¡®çš„çº¿ç¨‹å±‚å¯ä»¥ä¼˜åŒ–å¹¶è¡Œæ€§èƒ½ï¼Œå‡å°‘çº¿ç¨‹ç«äº‰å’Œç®¡ç†å¼€é”€ã€‚</li>
<li>TF_ENABLE_ONEDNN_OPTS&#x3D;1: è¿™ä¸ªç¯å¢ƒå˜é‡æ˜¯ä¸º TensorFlow è®¾ç½®çš„ï¼Œè¡¨ç¤ºå¯åŠ¨ä¸€äº›åŸºäº OneDNNï¼ˆä¹‹å‰ç§°ä¸º MKL-DNNï¼‰çš„ä¼˜åŒ–ã€‚</li>
</ul>
<p>æˆ‘ä»¬é¦–å…ˆè¿›è¡Œ SocialIQA å’Œ WinoGrande çš„è¯„æµ‹ï¼Œè¿™ 2 ä¸ªè¯„ä¼°æŒ‡æ ‡æ˜¯ç”¨äºè¯„ä¼° LLM ç†è§£ç¤¾ä¼šå¸¸è¯†å’Œè§£å†³æ­§ä¹‰é—®é¢˜èƒ½åŠ›çš„åŸºå‡†ï¼Œæµ‹è¯•ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">python run.py --datasets siqa_gen winograd_ppl \</span><br><span class="line">--hf-path meta-llama/Meta-Llama-3-8B-Instruct \</span><br><span class="line">--model-kwargs device_map=<span class="string">&#x27;auto&#x27;</span> \</span><br><span class="line">--tokenizer-kwargs padding_side=<span class="string">&#x27;left&#x27;</span> truncation=<span class="string">&#x27;left&#x27;</span> trust_remote_code=True \</span><br><span class="line">--max-seq-len 2048 \</span><br><span class="line">--max-out-len 100 \</span><br><span class="line">--batch-size 64 \</span><br><span class="line">--num-gpus 1</span><br><span class="line">--debug</span><br></pre></td></tr></table></figure>

<ul>
<li>datasets: æ•°æ®é›†åç§°</li>
<li>hf-path: HuggingFace æ¨¡å‹åœ°å€ï¼Œå¦‚æœæœ¬åœ°æ²¡æœ‰è¯¥æ¨¡å‹ä¼šè‡ªåŠ¨ä¸‹è½½</li>
<li>model-kwargs: æ„é€  model çš„å‚æ•°</li>
<li>tokenizer-kwargs: æ„é€  tokenizer çš„å‚æ•°</li>
<li>max-seq-len: æ¨¡å‹èƒ½æ¥å—çš„æœ€å¤§åºåˆ—é•¿åº¦</li>
<li>max-out-len: æœ€é•¿ç”Ÿæˆ token æ•°</li>
<li>batch-size: æ‰¹æ¬¡å¤§å°ï¼Œå¦‚æœè¿è¡Œè¿‡ç¨‹ä¸­æç¤ºæ˜¾å­˜ä¸è¶³ï¼Œå¯ä»¥é€‚å½“è°ƒå° batch-size</li>
<li>num-gpus: è¿è¡Œæ¨¡å‹æ‰€éœ€çš„æœ€å°‘ GPU æ•°é‡</li>
<li>debug: æ˜¯å¦å¼€å¯ debug æ¨¡å¼ï¼Œå»ºè®®æ˜¯å¼€å¯è°ƒè¯•æ¨¡å¼ï¼Œè¿™æ ·å¦‚æœæœ‰æŠ¥é”™ä¼šæ›´å®¹æ˜“å®šä½é—®é¢˜</li>
</ul>
<p>å¦‚æœç¨‹åºæ‰§è¡ŒæˆåŠŸï¼Œæœ€ååœ¨ç»ˆç«¯ä¼šè¾“å‡ºä¸‹é¢çš„ä¿¡æ¯ï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">dataset    version    metric    mode      opencompass....-Llama-3-8B-Instruct</span><br><span class="line">---------  ---------  --------  ------  -------------------------------------</span><br><span class="line">siqa       e78df3     accuracy  gen                     38.59</span><br><span class="line">winograd   b6c7ed     accuracy  ppl                     57.19</span><br></pre></td></tr></table></figure>

<p>è¿™å°±æ˜¯ Llama3 åœ¨ SocialIQA å’Œ WinoGrande è¯„æµ‹ä¸­çš„å¾—åˆ†ï¼Œåˆ†åˆ«æ˜¯ 38.59 å’Œ 57.19ã€‚è¯„æµ‹ç»“æœå¯ä»¥åœ¨ OpenCompass çš„ <code>outputs/default/&#123;timestamp&#125;/summary</code>ç›®å½•ä¸‹çš„ CSV æ–‡ä»¶ä¸­æŸ¥çœ‹ï¼Œå†…å®¹å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<img src="/images/post/2024/05/siqa-winograd.png" class="" width="1000" height="600">

<p>æˆ‘ä»¬å†æ¥è¿›è¡Œ HumanEval åŸºå‡†æµ‹è¯•ï¼ŒHumanEval æ˜¯ OpenAI åˆ›å»ºçš„åŸºå‡†æµ‹è¯•ï¼Œä¸»è¦ç”¨äºè¯„ä¼°è¯­è¨€æ¨¡å‹åœ¨ä»£ç ç”Ÿæˆä»»åŠ¡ä¸Šçš„èƒ½åŠ›ã€‚å®ƒåŒ…å«å¤šç§ç¼–ç¨‹é—®é¢˜ï¼Œæ¨¡å‹çš„ä»»åŠ¡æ˜¯ç”Ÿæˆç¬¦åˆé—®é¢˜è¦æ±‚çš„ä»£ç ã€‚è¯„ä¼°æ–¹å¼åŒ…æ‹¬è¿è¡Œæ¨¡å‹ç”Ÿæˆçš„ä»£ç å¹¶æ£€æµ‹å…¶è¾“å‡ºæ˜¯å¦æ­£ç¡®ï¼Œä»¥åŠéªŒè¯ä»£ç çš„åŠŸèƒ½æ˜¯å¦ç¬¦åˆé—®é¢˜çš„éœ€æ±‚ï¼Œæµ‹è¯•ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">python run.py --datasets humaneval_gen_8e312c \</span><br><span class="line">--hf-path meta-llama/Meta-Llama-3-8B-Instruct \</span><br><span class="line">--model-kwargs device_map=<span class="string">&#x27;auto&#x27;</span> \</span><br><span class="line">--tokenizer-kwargs padding_side=<span class="string">&#x27;left&#x27;</span> truncation=<span class="string">&#x27;left&#x27;</span> trust_remote_code=True \</span><br><span class="line">--max-seq-len 2048 \</span><br><span class="line">--max-out-len 100 \</span><br><span class="line">--batch-size 64 \</span><br><span class="line">--num-gpus 1</span><br><span class="line">--debug</span><br></pre></td></tr></table></figure>

<p>å¯ä»¥çœ‹åˆ°è¿è¡Œä»£ç ä»£ä¸ä¹‹å‰çš„åŸºæœ¬ä¸€è‡´ï¼Œåªæ˜¯ datasets å‚æ•°æ”¹ä¸º humaneval_gen_8e312cï¼Œæ•°æ®é›†çš„åç§°å¯ä»¥åœ¨ OpenCompass çš„ <code>configs/datasets</code>ç›®å½•ä¸‹æ‰¾åˆ°ï¼Œæ¯ä¸ªæ•°æ®é›†å¯¹åº”ä¸€ä¸ª Python æ–‡ä»¶ï¼Œä»¥ humaneval_gen_8e312c æ•°æ®é›†ä¸ºä¾‹ï¼Œå¯¹åº”çš„å°±æ˜¯<code>configs/datasets/humaneval/humaneval_gen_8e312c.py</code>è¿™ä¸ªæ–‡ä»¶ã€‚</p>
<p>åœ¨æ‰§è¡Œ HumanEval è¯„æµ‹æ—¶ï¼Œè¿˜éœ€è¦ä¿®æ”¹ä¹‹å‰ä¸‹è½½çš„ human-eval ä»£ç åº“ä¸­çš„ <code>human_eval/execution.py</code> æ–‡ä»¶ï¼Œå°†ç¬¬ 58 è¡Œçš„æ³¨é‡Šå–æ¶ˆï¼Œå¯ç”¨ä»£ç æ‰§è¡Œè¯„æµ‹ï¼Œè¿™æ ·æ‰èƒ½å¾—åˆ°æ­£ç¡®çš„è¯„æµ‹ç»“æœã€‚</p>
<figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"># WARNING</span><br><span class="line"># This program exists to execute untrusted model-generated code. Although</span><br><span class="line"># it is highly unlikely that model-generated code will do something overtly</span><br><span class="line"># malicious in response to this test suite, model-generated code may act</span><br><span class="line"># destructively due to a lack of model capability or alignment.</span><br><span class="line"># Users are strongly encouraged to sandbox this evaluation suite so that it</span><br><span class="line"># does not perform destructive actions on their host or network. For more</span><br><span class="line"># information on how OpenAI sandboxes its code, see the accompanying paper.</span><br><span class="line"># Once you have read this disclaimer and taken appropriate precautions,</span><br><span class="line"># uncomment the following line and proceed at your own risk:</span><br><span class="line"><span class="deletion">-#                         exec(check_program, exec_globals)</span></span><br><span class="line"><span class="addition">+                         exec(check_program, exec_globals)</span></span><br><span class="line">                result.append(&quot;passed&quot;)</span><br></pre></td></tr></table></figure>

<p>æ‰§è¡Œå®Œ HumanEval è¯„æµ‹åçš„ç»“æœå¦‚ä¸‹ï¼š</p>
<img src="/images/post/2024/05/humaneval.png" class="" width="1000" height="600">

<p>è¿™é‡Œ HumanEval çš„åˆ†æ•°æ˜¯ 51.83ï¼Œè€Œ Llama3 å®˜æ–¹çš„åˆ†æ•°æ˜¯ 62.2ï¼Œç›¸å·®æ¯”è¾ƒå¤šï¼Œå¯èƒ½æ˜¯å› ä¸ºå®˜æ–¹è¯„æµ‹æ‰€ç”¨çš„æç¤ºè¯ä¸ OpenCompass çš„ä¸ç›¸åŒï¼Œæ‰€ä»¥å¾—åˆ†ä¼šæœ‰æ‰€å·®å¼‚ã€‚</p>
<p>æœ€åå†æ¥è¿›è¡Œ GSM8K è¯„æµ‹ï¼ŒGSM8K æ˜¯ä¸€ä¸ªç”¨äºè¯„ä¼°è¯­è¨€æ¨¡å‹åœ¨æ•°å­¦æ¨ç†å’Œé—®é¢˜è§£å†³èƒ½åŠ›æ–¹é¢çš„åŸºå‡†ã€‚è¿™ä¸ªåŸºå‡†åŒ…å« 8000 ä¸ªåŸºäºå°å­¦æ•°å­¦çš„é¢˜ç›®ï¼Œæ¶µç›–äº†å„ç§æ•°å­¦ä¸»é¢˜ã€‚è¯„ä¼°ä¸»è¦çœ‹æ¨¡å‹åœ¨è§£å†³è¿™äº›æ•°å­¦é—®é¢˜æ—¶çš„å‡†ç¡®æ€§å’Œæ¨ç†èƒ½åŠ›ï¼Œæµ‹è¯•ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">python run.py --datasets gsm8k_gen_1d7fe4 \</span><br><span class="line">--hf-path meta-llama/Meta-Llama-3-8B-Instruct \</span><br><span class="line">--model-kwargs device_map=<span class="string">&#x27;auto&#x27;</span> \</span><br><span class="line">--tokenizer-kwargs padding_side=<span class="string">&#x27;left&#x27;</span> truncation=<span class="string">&#x27;left&#x27;</span> trust_remote_code=True \</span><br><span class="line">--max-seq-len 2048 \</span><br><span class="line">--max-out-len 100 \</span><br><span class="line">--batch-size 64 \</span><br><span class="line">--num-gpus 1</span><br><span class="line">--debug</span><br></pre></td></tr></table></figure>

<p>æ‰§è¡Œå®Œ GSM8K è¯„æµ‹åçš„ç»“æœå¦‚ä¸‹ï¼š</p>
<img src="/images/post/2024/05/gsm8k.png" class="" width="1000" height="600">

<p>å®é™…è¯„æµ‹ GSM8K çš„åˆ†æ•°æ˜¯ 78.7ï¼Œè€Œ Llama3 å®˜æ–¹å¾—åˆ†æ˜¯ 79.6ï¼Œè¿™ä¸€æ¬¡ä¸¤è€…çš„å¾—åˆ†æ¯”è¾ƒæ¥è¿‘ã€‚</p>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>æœ¬æ–‡ä¸»è¦ä»‹ç»äº† LLM çš„åŸºå‡†æµ‹è¯•æŒ‡æ ‡ï¼Œä»¥åŠå¦‚ä½•ä½¿ç”¨ OpenCompass è¯„æµ‹æœ€æ–°çš„å¼€æºæ¨¡å‹ Llama3 å¹¶å¾—åˆ°æŒ‡æ ‡å¾—åˆ†ã€‚é€šè¿‡ OpenCompass çš„è¯„æµ‹ï¼Œæˆ‘ä»¬å¯ä»¥æ›´å…¨é¢åœ°äº†è§£ Llama3 çš„æ€§èƒ½è¡¨ç°ã€‚LLM åŸºå‡†åœ¨ä¸€èˆ¬æƒ…å†µä¸‹æ˜¯æœ‰å¸®åŠ©çš„ï¼Œä½†éšç€åŸºå‡†çš„æ—¥ç›Šæ™®åŠï¼Œæ–°çš„æ¨¡å‹å¯ä»¥è¢«è®­ç»ƒæˆ–å¾®è°ƒä»¥è·å¾—åŸºå‡†æµ‹è¯•é«˜åˆ†ï¼Œè¿™ä½¿å¾—æ¨¡å‹çš„å¾—åˆ†å¹¶ä¸çœŸå®åæ˜ å…¶åœ¨è¢«è¯„ä¼°æ–¹é¢çš„èƒ½åŠ›ï¼ŒæœŸå¾…è¿™ä¸€é—®é¢˜èƒ½åœ¨æ—¥åå¯ä»¥å¾—åˆ°æ”¹å–„ã€‚</p>
<p>å…³æ³¨æˆ‘ï¼Œä¸€èµ·å­¦ä¹ å„ç§äººå·¥æ™ºèƒ½å’Œ AIGC æ–°æŠ€æœ¯ï¼Œæ¬¢è¿äº¤æµï¼Œå¦‚æœä½ æœ‰ä»€ä¹ˆæƒ³é—®æƒ³è¯´çš„ï¼Œæ¬¢è¿åœ¨è¯„è®ºåŒºç•™è¨€ã€‚</p>
</div>

</article>
<section id="appreciates">
  <center>
	<h2>èµèµ</h2>
    <div class="post-footer">
      <div>
	    <h4>å¦‚æœæ–‡ç« å¯¹æ‚¨æœ‰æ‰€å¸®åŠ©ï¼Œå¯ä»¥æèµ æˆ‘å–æ¯å’–å•¡ğŸ˜Œï¼Œæèµ æ–¹å¼ï¼š</h4>
        <div class="digital-wallet">
          <h6>BTC åœ°å€ï¼š3LYgSyf7ddMALwGWPQr3PY4wzjsTDdg1oV</h6>
          <h6>ETH åœ°å€ï¼š0x0C9b27c89A61aadb0aEC24CA8949910Cbf77Aa73</h6>
        </div>
        <div class="wechat_appreciates">
          <img src="/images/wechat_appreciates.png" alt="qrcode" width="250" >
        </div>
      </div>
      <div>
	    <h4>æ–‡ç« å·²åŒæ­¥æ›´æ–°å…¬ä¼—å·ï¼Œæ¬¢è¿å…³æ³¨</h4>
        <div class="wechat_appreciates">
          <img src="/images/wxgzh_qrcode.jpg" alt="qrcode" width="250" >
        </div>
      </div>
    </div>
  </center>
</section>



    
      <script type="text/javascript">
        var disqus_config = function () {
            this.page.url = 'https://zhaozhiming.github.io/2024/04/29/use-opencompass-evaluate-llama3/';
            this.page.identifier = 'https://zhaozhiming.github.io/2024/04/29/use-opencompass-evaluate-llama3/';
        };

        (function() {
          var d = document, s = d.createElement('script');
          s.src = '//zhaozhiming.disqus.com/embed.js';
          s.setAttribute('data-timestamp', +new Date());
          (d.head || d.body).appendChild(s);
        })();
      </script>
    



<section id="comment">
    <h2 class="title">Comments</h2>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a target="_blank" rel="noopener" href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
</section>

</div>

    </div>
    <footer id="footer">
    <div style="display:inline">
    Copyright &copy; 2025

    èµµèŠæ˜
. Powered by <a href="http://zespia.tw/hexo/" target="_blank">Hexo</a> |
    Theme is <a target="_blank" rel="noopener" href="https://github.com/wd/hexo-fabric">hexo-fabric</a>, fork from <a target="_blank" rel="noopener" href="http://github.com/panks/fabric">fabric</a> by <a target="_blank" rel="noopener" href="http://panks.me">Pankaj Kumar</a>
</div>


    </footer>
    <script src="/javascripts/fabric.js"></script>
<script src="/javascripts/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
	$('.fancybox').fancybox();
})(jQuery);
</script>
 <!-- Delete or comment this line to disable Fancybox -->



<!-- end toload --> 
</div>
</div>
<script src="/javascripts/jquery.ui.totop.js" type="text/javascript"></script>
<script type="text/javascript">
/*<![CDATA[*/
;(function($){$().UItoTop({easingType:'easeOutCirc'});})(jQuery); 
/*]]>*/
</script><!-- remove it to remove the scroll to top button -->
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5608723650603289" crossorigin="anonymous"></script>
</body>
</html>
