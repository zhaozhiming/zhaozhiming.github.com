<!DOCTYPE HTML>
<html>
<head>
	<meta charset="utf-8">
    
	<title>都 2024 年了，你还在用 pip 吗？ - Hacker and Geeker&#39;s Way</title>
    <meta name="author" content="">
    
	<meta name="description" content="介绍新一代 Python 项目常用工具，以及如何在项目中使用"> <!-- TODO: truncate -->
	<meta name="keywords" content="python, miniconda, poetry, ruff, uv">
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

	<link href="atom.xml" rel="alternate" title="Hacker and Geeker&#39;s Way" type="application/atom+xml">
	<link href="/favicon.ico" rel="shortcut icon">
    <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
    <link href="/stylesheets/custom.css" media="screen, projection" rel="stylesheet" type="text/css">
    <link href="/stylesheets/hljs.css" media="screen, projection" rel="stylesheet" type="text/css">

    <link href='/stylesheets/font.css?family=Slackey' rel='stylesheet' type='text/css'>
    <link href='/stylesheets/font.css?family=Fjalla+One' rel='stylesheet' type='text/css'>
    <link href='/stylesheets/font.css?family=Amethysta+One' rel='stylesheet' type='text/css'>
	  <script src="/javascripts/jquery.min.js"></script>
    <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![}]-->

    <script type="text/javascript" src="/javascripts/jquery-tapir.js"></script>

    <!-- remove or comment it to disable ajaxification -->   
    <!-- <script src="/javascripts/ajaxify.js"></script> -->

    

    
	<script type="text/javascript">
		var _gaq = _gaq || [];
		_gaq.push(['_setAccount', 'UA-100485541-1']);
		_gaq.push(['_trackPageview']);

		(function() {
			var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
			ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
			var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
		})();
	</script>


<meta name="generator" content="Hexo 6.3.0"></head>


<body>
    <div id="wrapper">
    <header id="header" class="inner"><!-- for more effects see _animate.scss -->
<h1 class="animated bounceInDown">
    <div id="headerbg">
        Hacker and Geeker&#39;s Way
    </div>
</h1>
<span class="subtitle"></span>
<br>

<ul id="social-links" style="text-align:center; clear:both;">
  
  <!-- GitHub -->
  <li>
  <a target="_blank" rel="noopener" href="https://github.com/zhaozhiming" class="github" title="Github"></a>
  </li>
  
  
  
  
  <!-- Twitter -->
  <li>
  <a target="_blank" rel="noopener" href="http://www.twitter.com/kingzzm" class="twitter" title="Twitter"></a>
  </li>
  
  
  <!-- LinkedIn -->
  <li>
  <a target="_blank" rel="noopener" href="http://www.linkedin.com/in/zhaozhiming" class="linkedin" title="LinkedIn"></a>
  </li>
  
  
  
  
  
  <!-- Stackoverflow -->
  <li>
  <a target="_blank" rel="noopener" href="http://stackoverflow.com/users/1954315/zhaozhiming" class="stackoverflow" title="Stackoverflow"></a>
  </li>
  
</ul>


<!-- use full url including 'index.html' for navigation bar if you are using ajax -->
<ul id="nav">
	<li id="ajax"><a href="/index.html">Home</a></li>
	<li id="ajax"><a href="/archives/index.html">Archives</a></li>
    <li><a href="/atom.xml">RSS</a></li>
    <li><a href="/about/index.html">About</a></li>
    
    <li>
    <div id="dark">
        <form action="//www.google.com.hk/search" method="get" accept-charset="UTF-8" id="search">
            <input type="hidden" name="sitesearch" value="https://zhaozhiming.github.io" />
            <input type="text" name="q" results="0" placeholder="Search..." x-webkit-speech />
        </form>
    </div>
    </li>
        
</ul>




</header>


<div id="toload">
<!-- begin toload -->
    <div id="content">
        <div class="inner">
<article class="post">
	<h2 class="title">都 2024 年了，你还在用 pip 吗？</h2>
    <div class="meta">
        <div class="date">Published on: <time datetime="2024-07-15T02:49:25.000Z" itemprop="datePublished">7月 15, 2024</time>
</div>
        <div class="tags">Tags: 

<a href="/tags/python/">python</a> <a href="/tags/miniconda/">miniconda</a> <a href="/tags/poetry/">poetry</a> <a href="/tags/ruff/">ruff</a> <a href="/tags/uv/">uv</a>
</div>
    </div>
	<div class="entry-content"><img src="/images/post/2024/07/next-generation-python-tools.jpg" class="" width="400" height="300">

<p>编程语言 Python 随着 AI 的发展越来越受开发人员的喜爱，目前已经是最流行的编程语言，但由于 Python 是一门相对较老的语言，并且经过 Python2 到 Python3 这一漫长而复杂的迁移历程，使得一些 Python 开发人员可能还在使用一些过时的工具和库。今天我们就来带大家了解当前 Python 生态系统中最流行最实用的开发工具，让你彻底告别那些<code>老古董</code>。</p>
<span id="more"></span>

<h2 id="Python-环境管理工具"><a href="#Python-环境管理工具" class="headerlink" title="Python 环境管理工具"></a>Python 环境管理工具</h2><p>Python 项目中虚拟环境的管理非常重要，虚拟环境可以帮助我们在不同项目中使用不同的 Python 版本和依赖库，避免不同项目之间的依赖冲突。Python 最早使用的是 <code>virtualenv</code> 工具来管理虚拟环境，到了 Python3.3 后自带了内置的创建虚拟环境模块 <code>venv</code>，但它们都存在一个问题，就是只能使用同一个 Python 版本创建虚拟环境。假如你在 A 项目想使用 Python3.10，而在 B 项目想使用 Python3.9，那么你就需要安装两个不同版本的 Python，然后分别使用 <code>virtualenv</code> 或 <code>venv</code> 来创建虚拟环境。</p>
<p>在使用了一些 Python 环境管理工具后，我比较推荐 <a target="_blank" rel="noopener" href="https://docs.anaconda.com/miniconda/">Miniconda</a> 这个工具，它是一个轻量级的 Conda 版本，可以帮助我们管理 Python 环境和依赖库，但我一般不使用它来管理依赖库，主要使用它来管理 Python 环境。</p>
<p>虽然 Miniconda 与其他 Python 环境管理工具（比如 <a target="_blank" rel="noopener" href="https://github.com/pyenv/pyenv">pyenv</a>）相比会重量级一些（包含了一些数据科学相关的库），而且功能也不是很纯粹（即有环境管理也有依赖管理等功能）， 但是它的优势在于环境管理的功能非常出色，可以轻松地在不同操作系统上进行安装，同时适配 bash、fish、zsh 等不同的 shell 环境，而且跟 <code>virtualenv</code> 和 <code>venv</code> 一起使用也不会引起冲突。</p>
<h3 id="Miniconda-使用示例"><a href="#Miniconda-使用示例" class="headerlink" title="Miniconda 使用示例"></a>Miniconda 使用示例</h3><p>以下是 Miniconda 的一些常用命令：</p>
<ul>
<li>创建 Python 环境： <code>conda create -n myenv python=3.10</code></li>
<li>切换 Python 环境： <code>conda activate myenv</code></li>
<li>展示所有 Python 环境： <code>conda env list</code></li>
<li>初始化 shell 环境： <code>conda init &lt;bash/fish/zsh&gt;</code></li>
</ul>
<h2 id="Python-依赖管理工具"><a href="#Python-依赖管理工具" class="headerlink" title="Python 依赖管理工具"></a>Python 依赖管理工具</h2><p>Python 项目中最常使用的工具应该要属 Pip 了，Pip 是 Python 的依赖管理工具，用于安装和管理 Python 依赖，虽然 Pip 功能强大，但在管理项目依赖时存在一些问题，比如新增依赖时需要手动修改 <code>requirements.txt</code> 文件，而且没有版本锁定功能，导致在不同环境中安装的依赖版本可能不一致。</p>
<p>其他编程语言比如 JS 则能有效地处理这种情况，使用它的依赖管理工具 <code>npm</code> 会产生一个 <code>package.json</code> 文件来管理项目依赖，然后生成一个 <code>package-lock.json</code> 文件来锁定依赖版本，确保在不同环境中安装相同的依赖版本。</p>
<p>为了解决这一问题，在 Python 中出现了不少依赖管理工具，<a target="_blank" rel="noopener" href="https://python-poetry.org/">Poetry</a> 是其中一个比较流行的工具。Poetry 使用一个 <code>pyproject.toml</code> 文件来管理项目的所有依赖项和元数据，使项目配置更加简洁明了，它会自动处理依赖项的版本冲突，并且能够生成锁文件 <code>poetry.lock</code>，确保在不同环境中安装相同的依赖版本。</p>
<h3 id="Poetry-安装"><a href="#Poetry-安装" class="headerlink" title="Poetry 安装"></a>Poetry 安装</h3><p>Poetry 有多种安装方式，最简单的是通过 Python 脚本进行安装，安装命令如下：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -sSL https://install.python-poetry.org | python3 -</span><br></pre></td></tr></table></figure>

<p>安装完成后，可以通过 Miniconda 创建一个特定版本的 Python 环境，然后在这个环境中使用 Poetry，具体操作如下：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 使用 conda 创建一个 Python 环境</span></span><br><span class="line">conda create -n myenv python=3.10</span><br><span class="line"><span class="comment"># 切换到这个 Python 环境</span></span><br><span class="line">conda activate myenv</span><br><span class="line"><span class="comment"># 构建一个 Poetry 虚拟环境</span></span><br><span class="line">poetry <span class="built_in">env</span> use python</span><br><span class="line"><span class="comment"># 进入该环境</span></span><br><span class="line">poetry shell</span><br></pre></td></tr></table></figure>

<h3 id="Poetry-使用示例"><a href="#Poetry-使用示例" class="headerlink" title="Poetry 使用示例"></a>Poetry 使用示例</h3><p>在新项目中使用 Poetry 可以使用 <code>poetry new &lt;project_name&gt;</code> 来创建一个新的 Python 项目，如果是已有项目，可以在项目目录中使用 <code>poetry init</code> 命令来初始化项目，这两个命令都会生成一个 <code>pyproject.toml</code> 文件，用于管理项目的依赖项和元数据。</p>
<p>你可以使用 <code>poetry install</code> 来安装项目的所有依赖，如果是初次运行该命令，Poetry 会生成一个 <code>poetry.lock</code> 文件，用于锁定项目的依赖版本，确保在不同环境中安装相同的依赖版本。也可以使用 <code>poetry add &lt;package_name&gt;</code> 命令来单独添加一个依赖，这样 Poetry 会自动更新 <code>pyproject.toml</code> 和 <code>poetry.lock</code> 文件。</p>
<p>我们通过一个简单的例子来看下 Poetry 对依赖管理的方法，假设我们在项目中安装了一个新的依赖 <code>requests</code>，那么可以使用如下命令：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">poetry add requests</span><br></pre></td></tr></table></figure>

<p>安装完成后，在 <code>pyproject.toml</code> 文件中只会添加 <code>requests</code> 这个依赖的信息：</p>
<figure class="highlight toml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">[tool.poetry.dependencies]</span></span><br><span class="line"><span class="attr">requests</span> = <span class="string">&quot;^2.32.3&quot;</span></span><br></pre></td></tr></table></figure>

<p>但是在 <code>poetry.lock</code> 文件会中除了添加 <code>requests</code> 这个依赖外，还会添加 <code>requests</code> 这个依赖所需的其他依赖库的信息，可以使用以下命令查看依赖之间的关系：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$ poetry show --tree</span><br><span class="line">requests 2.32.3 Python HTTP <span class="keyword">for</span> Humans.</span><br><span class="line">├── certifi &gt;=2017.4.17</span><br><span class="line">├── charset-normalizer &gt;=2,&lt;4</span><br><span class="line">├── idna &gt;=2.5,&lt;4</span><br><span class="line">└── urllib3 &gt;=1.21.1,&lt;3</span><br></pre></td></tr></table></figure>

<p>可以看到 <code>requests</code> 是项目根目录下的依赖，而其他几个依赖是 <code>requests</code> 所需的依赖。</p>
<p>如果你用 Pip 来安装依赖，那么 <code>pip install requests</code> 后再用 <code>pip freeze &gt; requirements.txt</code> 命令生成的 <code>requirements.txt</code> 文件会包含所有依赖的信息，使得你分不清哪些是项目的依赖，哪些是衍生的依赖。</p>
<p>Poetry 还允许你将 lock 文件导出成 <code>requirements.txt</code> 文件，这样你就可以使用 <code>pip install -r requirements.txt</code> 来安装项目的依赖，具体命令如下：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">poetry <span class="built_in">export</span> --without-hashes --format=requirements.txt --output requirements.txt</span><br></pre></td></tr></table></figure>

<p>更多的 Poetry 使用方法可以参<a target="_blank" rel="noopener" href="https://python-poetry.org/docs/">考官方文档</a>。</p>
<h3 id="其他依赖管理工具"><a href="#其他依赖管理工具" class="headerlink" title="其他依赖管理工具"></a>其他依赖管理工具</h3><p>除了 Poetry 外，还有一些其他的 Python 依赖管理工具，比如 <a target="_blank" rel="noopener" href="https://pdm-project.org/en/latest/">Pdm</a> 就是不错的选择，它整体和 Poetry 类似，它还包含了 Python 环境管理的功能，这样就不需要和 Miniconda 配合也可直接使用，但是在流行度上比 Poetry 稍微逊色一些（截止时间 2024 年 7 月，Poetry 的 Github Star 数是 30K，而 Pdm 的 Github Star 数是 7.6K），可能是 Pdm 比 Poetry 发布时间晚的关系（Poetry 是 2018 年发布的，而 Pdm 是 2020 年发布的），后面如果 Pdm 发展的好的话，说不定会超过 Poetry。</p>
<p>另外一个值得推荐的 Python 依赖管理工具是 <a target="_blank" rel="noopener" href="https://github.com/astral-sh/uv">Uv</a>，它是一款用 Rust 编写的极速 Python 包安装和解析工具，旨在作为 Pip 和 Pip-tools 的替代品，并逐步发展成为一个全面的 Python 项目和包管理器，下面是它和其他工具安装依赖的速度对比图：</p>
<img src="/images/post/2024/07/uv-compare.png" class="" width="1000" height="600">

<p>得益于 Rust 的高性能，在速度上 Uv 完全碾压了其他工具，但可惜的是 Uv 目前还是使用 <code>requirements.txt</code> 来管理依赖，这样就无法保证可以在不同环境安装相同的依赖，而且 Uv 也不能和 Poetry 一起使用，因为 Uv 是按照兼容 Pip 的思路进行开发，而 Poetry 内部已经不用 Pip 做依赖管理了。</p>
<p>尽管 Uv 无法和 Poetry 一起使用，但是我们可以在 CI&#x2F;CD 中使用 Uv 来加速依赖安装，比如我们先用 Poetry 导出 <code>requirements.txt</code> 文件，然后在 CI&#x2F;CD 中使用 Uv 来安装依赖，这样就可以大大缩短依赖安装的时间。</p>
<h3 id="Pip-是否过时"><a href="#Pip-是否过时" class="headerlink" title="Pip 是否过时"></a>Pip 是否过时</h3><p>虽然这些依赖管理工具很强大，但一些小型项目可能更多开发人员还是会选择 Pip，因为 Pip 无需额外安装其他工具，一般有 Python 环境就可以直接使用。另外一点是编程语言的原生工具也在不断发展，以 JS 为例，npm 刚开始时也不支持 lock 文件，但后面参考了一些 JS 的流行工具，在社区的共同努力下慢慢完善了这个功能，所以 Pip 也有可能在未来的某个版本中加入类似 Poetry 的功能。</p>
<p>所以在 Pip 没有发展完善之前，我们可以使用 Poetry 这样的工具来解决依赖管理的问题，同时也能简化项目配置，提高开发效率。</p>
<h2 id="代码规范工具"><a href="#代码规范工具" class="headerlink" title="代码规范工具"></a>代码规范工具</h2><p>另外一种常用的工具是代码规范类工具，因为 Python 的语法比较灵活，所以在团队协作中可能会出现代码风格不一致的问题，为了解决这个问题，每种编程语言都会有一些代码规范工具，这类工具包括代码格式化工具、代码检查工具等。</p>
<p>在 Python 中代码格式化工具有 <a target="_blank" rel="noopener" href="https://github.com/psf/black">Black</a>、<a target="_blank" rel="noopener" href="https://github.com/google/yapf">YAPF</a>、<a target="_blank" rel="noopener" href="https://github.com/hhatto/autopep8">autopep8</a> 等，而代码检查工具有 <a target="_blank" rel="noopener" href="https://github.com/PyCQA/flake8">Flake8</a>、<a target="_blank" rel="noopener" href="https://github.com/pylint-dev/pylint">Pylint</a>、<a target="_blank" rel="noopener" href="https://github.com/python/mypy">mypy</a> 等，这些工具都可以通过 Pip 来安装，然后在项目中使用。</p>
<p>而最近比较流行的一个代码规范工具 <a target="_blank" rel="noopener" href="https://github.com/astral-sh/ruff">Ruff</a>，它同时集成了代码格式化和代码检查功能，可以帮助我们更好地在项目中统一代码风格。Ruff 是 Uv 开发团队开发的另外一款工具，同样是使用 Rust 语言进行编写，从而使它的性能远远高于其他同类型的工具，下面是 Ruff 和其他工具的性能对比图：</p>
<img src="/images/post/2024/07/ruff-compare.png" class="" width="1000" height="600">

<p>Ruff 内部集成了 Black 和 Flake8 等工具，下面我们就来介绍下 Ruff 如何安装及使用。</p>
<h3 id="Ruff-安装"><a href="#Ruff-安装" class="headerlink" title="Ruff 安装"></a>Ruff 安装</h3><p>Ruff 可以通过 Pip 或 Poetry 进行安装，在项目中使用的话，推荐使用 Poetry 安装到 dev 开发依赖中，表示这个工具只在开发环境中使用，具体命令如下：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">poetry add --dev ruff</span><br></pre></td></tr></table></figure>

<p>如果想让 Ruff 在本地 IDE 中使用的话，建议是进行全局安装，这样就可以在任何项目中使用 Ruff，具体命令如下：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -LsSf https://astral.sh/ruff/install.sh | sh</span><br></pre></td></tr></table></figure>

<p>安装完成后，可以通过 IDE 的插件来使用 Ruff，比如在 VSCode 中安装 <a target="_blank" rel="noopener" href="https://marketplace.visualstudio.com/items?itemName=charliermarsh.ruff">Ruff 插件</a>，然后在 VSCode 中使用快捷键 <code>Ctrl+Shift+P</code> 打开命令面板，输入 <code>user config</code> 打开用户配置文件，然后添加 Ruff 安装后的路径：</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;ruff.path&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;/your/ruff/path&quot;</span><span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<h3 id="Ruff-使用示例"><a href="#Ruff-使用示例" class="headerlink" title="Ruff 使用示例"></a>Ruff 使用示例</h3><p>Ruff 主要有 2 个命令，分别是 <code>ruff check</code> 和 <code>ruff format</code>，前者用于代码检查，后者用于代码格式化。</p>
<p>为了保证团队的代码风格一致，我们可以在 Git 的 hook 中添加 Ruff 检查命令，这样每个人在执行 <code>git commit</code> 命令时就会自动执行 Ruff 命令，如果检查失败则无法提交代码。</p>
<p>首先我们需要安装 <a target="_blank" rel="noopener" href="https://pre-commit.com/">pre-commit</a> 工具，这个工具可以让我们在 Git hook 上轻松配置命令，同样将其安装到 dev 开发依赖即可：<code>poetry add --dev pre-commit</code>，然后在项目根目录下添加 <code>.pre-commit-config.yaml</code> 文件，内容如下：</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">repos:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">repo:</span> <span class="string">https://github.com/astral-sh/ruff-pre-commit</span></span><br><span class="line">    <span class="comment"># Ruff 版本</span></span><br><span class="line">    <span class="attr">rev:</span> <span class="string">v0.5.1</span></span><br><span class="line">    <span class="attr">hooks:</span></span><br><span class="line">      <span class="comment"># 执行 ruff check</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">id:</span> <span class="string">ruff</span></span><br><span class="line">        <span class="comment"># 可选参数，自动修复代码</span></span><br><span class="line">        <span class="attr">args:</span> [<span class="string">--fix</span>]</span><br><span class="line">      <span class="comment"># 执行 ruff format</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">id:</span> <span class="string">ruff-format</span></span><br></pre></td></tr></table></figure>

<ul>
<li>在文件中我们添加 Ruff 工具来处理代码提交时的检查</li>
<li>我们添加了 2 个工具，第一个工具 id 是 <code>ruff</code> 表示执行 <code>ruff check</code> 命令，第二个工具 id 是 <code>ruff-format</code> 表示执行 <code>ruff format</code> 命令</li>
<li>第一个工具还有一个可选参数 <code>args: [--fix]</code>，表示会自动修复检查出有误的代码，但也不是所有代码都能自动修复，有些代码还是需要手动修复的</li>
</ul>
<p>最后我们在项目中执行 <code>pre-commit install</code> 命令，将文件内容添加到 Git hook 中：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ pre-commit install</span><br><span class="line">pre-commit installed at .git/hooks/pre-commit</span><br></pre></td></tr></table></figure>

<p>配置完成后，我们故意写一些代码错误，然后提交代码， 检查结果如下：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">$ git commit -m <span class="string">&#x27;add some feature&#x27;</span></span><br><span class="line">ruff.....................................................................Failed</span><br><span class="line">- hook <span class="built_in">id</span>: ruff</span><br><span class="line">- <span class="built_in">exit</span> code: 1</span><br><span class="line"></span><br><span class="line">main.py:1:8: F401 [*] `requests` imported but unused</span><br><span class="line">  |</span><br><span class="line">1 | import requests</span><br><span class="line">  |        ^^^^^^^^ F401</span><br><span class="line">  |</span><br><span class="line">  = <span class="built_in">help</span>: Remove unused import: `requests`</span><br><span class="line"></span><br><span class="line">Found 1 error.</span><br><span class="line">[*] 1 fixable with the `--fix` option.</span><br><span class="line"></span><br><span class="line">ruff-format..............................................................Passed</span><br></pre></td></tr></table></figure>

<p>可以看到代码检查任务失败了，报了 <code>imported but unused</code> 的错误，错误编号 <code>F401</code>，第二个任务代码格式化检查通过。</p>
<p>如果想在代码中不检查某行代码，可以在代码行后面加上 <code># noqa: &#123;error_code&#125;</code>，比如：</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests <span class="comment"># noqa: F401</span></span><br></pre></td></tr></table></figure>

<p>这样就可以在 Ruff 检查时忽略这个错误。更多的 Ruff 使用方法可以参<a target="_blank" rel="noopener" href="https://docs.astral.sh/ruff/tutorial/">考官方文档</a>。</p>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>今天我们介绍了 Python 中新一代的项目工具，新工具带来的好处是开发效率的提升，因为每个新工具都是在解决旧工具的不足之处，是在旧工具的基础上进行了优化和改进。作为一个热衷提高生产力的开发人员，可以在适当时机尝试使用这些新工具，如果觉得新工具不合适，也可以退回去重新使用旧工具，关键在于尝试。</p>
<p>关注我，一起学习各种人工智能和 GenAI 新技术，欢迎交流，如果你有什么想问想说的，欢迎在评论区留言。</p>
</div>

</article>
<section id="appreciates">
  <center>
	<h2>赞赏</h2>
    <div class="post-footer">
      <div>
	    <h4>如果文章对您有所帮助，可以捐赠我喝杯咖啡😌，捐赠方式：</h4>
        <div class="digital-wallet">
          <h6>BTC 地址：3LYgSyf7ddMALwGWPQr3PY4wzjsTDdg1oV</h6>
          <h6>ETH 地址：0x0C9b27c89A61aadb0aEC24CA8949910Cbf77Aa73</h6>
        </div>
        <div class="wechat_appreciates">
          <img src="/images/wechat_appreciates.png" alt="qrcode" width="250" >
        </div>
      </div>
      <div>
	    <h4>文章已同步更新公众号，欢迎关注</h4>
        <div class="wechat_appreciates">
          <img src="/images/wxgzh_qrcode.jpg" alt="qrcode" width="250" >
        </div>
      </div>
    </div>
  </center>
</section>



    
      <script type="text/javascript">
        var disqus_config = function () {
            this.page.url = 'https://zhaozhiming.github.io/2024/07/15/modern-python-project-tools-config/';
            this.page.identifier = 'https://zhaozhiming.github.io/2024/07/15/modern-python-project-tools-config/';
        };

        (function() {
          var d = document, s = d.createElement('script');
          s.src = '//zhaozhiming.disqus.com/embed.js';
          s.setAttribute('data-timestamp', +new Date());
          (d.head || d.body).appendChild(s);
        })();
      </script>
    



<section id="comment">
    <h2 class="title">Comments</h2>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a target="_blank" rel="noopener" href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
</section>

</div>

    </div>
    <footer id="footer">
    <div style="display:inline">
    Copyright &copy; 2024

    赵芝明
. Powered by <a href="http://zespia.tw/hexo/" target="_blank">Hexo</a> |
    Theme is <a target="_blank" rel="noopener" href="https://github.com/wd/hexo-fabric">hexo-fabric</a>, fork from <a target="_blank" rel="noopener" href="http://github.com/panks/fabric">fabric</a> by <a target="_blank" rel="noopener" href="http://panks.me">Pankaj Kumar</a>
</div>


    </footer>
    <script src="/javascripts/fabric.js"></script>
<script src="/javascripts/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
	$('.fancybox').fancybox();
})(jQuery);
</script>
 <!-- Delete or comment this line to disable Fancybox -->



<!-- end toload --> 
</div>
</div>
<script src="/javascripts/jquery.ui.totop.js" type="text/javascript"></script>
<script type="text/javascript">
/*<![CDATA[*/
;(function($){$().UItoTop({easingType:'easeOutCirc'});})(jQuery); 
/*]]>*/
</script><!-- remove it to remove the scroll to top button -->
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5608723650603289" crossorigin="anonymous"></script>
</body>
</html>
