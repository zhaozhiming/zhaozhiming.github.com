<!DOCTYPE HTML>
<html>
<head>
	<meta charset="utf-8">
    
	<title>深入解析 Solana 交易 - Hacker and Geeker&#39;s Way</title>
    <meta name="author" content="">
    
	<meta name="description" content="深入解析 Solana 交易，包括查看方式、交易结构、交易解析等。"> <!-- TODO: truncate -->
	<meta name="keywords" content="solana, transaction, solana-explorer, solscan, solana-rpc">
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

	<link href="atom.xml" rel="alternate" title="Hacker and Geeker&#39;s Way" type="application/atom+xml">
	<link href="/favicon.ico" rel="shortcut icon">
    <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
    <link href="/stylesheets/custom.css" media="screen, projection" rel="stylesheet" type="text/css">
    <link href="/stylesheets/hljs.css" media="screen, projection" rel="stylesheet" type="text/css">

    <link href='/stylesheets/font.css?family=Slackey' rel='stylesheet' type='text/css'>
    <link href='/stylesheets/font.css?family=Fjalla+One' rel='stylesheet' type='text/css'>
    <link href='/stylesheets/font.css?family=Amethysta+One' rel='stylesheet' type='text/css'>
	  <script src="/javascripts/jquery.min.js"></script>
    <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![}]-->

    <script type="text/javascript" src="/javascripts/jquery-tapir.js"></script>

    <!-- remove or comment it to disable ajaxification -->   
    <!-- <script src="/javascripts/ajaxify.js"></script> -->

    

    
	<script type="text/javascript">
		var _gaq = _gaq || [];
		_gaq.push(['_setAccount', 'UA-100485541-1']);
		_gaq.push(['_trackPageview']);

		(function() {
			var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
			ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
			var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
		})();
	</script>


<meta name="generator" content="Hexo 6.3.0"></head>


<body>
    <div id="wrapper">
    <header id="header" class="inner"><!-- for more effects see _animate.scss -->
<h1 class="animated bounceInDown">
    <div id="headerbg">
        Hacker and Geeker&#39;s Way
    </div>
</h1>
<span class="subtitle"></span>
<br>

<ul id="social-links" style="text-align:center; clear:both;">
  
  <!-- GitHub -->
  <li>
  <a target="_blank" rel="noopener" href="https://github.com/zhaozhiming" class="github" title="Github"></a>
  </li>
  
  
  
  
  <!-- Twitter -->
  <li>
  <a target="_blank" rel="noopener" href="http://www.twitter.com/kingzzm" class="twitter" title="Twitter"></a>
  </li>
  
  
  <!-- LinkedIn -->
  <li>
  <a target="_blank" rel="noopener" href="http://www.linkedin.com/in/zhaozhiming" class="linkedin" title="LinkedIn"></a>
  </li>
  
  
  
  
  
  <!-- Stackoverflow -->
  <li>
  <a target="_blank" rel="noopener" href="http://stackoverflow.com/users/1954315/zhaozhiming" class="stackoverflow" title="Stackoverflow"></a>
  </li>
  
</ul>


<!-- use full url including 'index.html' for navigation bar if you are using ajax -->
<ul id="nav">
	<li id="ajax"><a href="/index.html">Home</a></li>
	<li id="ajax"><a href="/archives/index.html">Archives</a></li>
    <li><a href="/atom.xml">RSS</a></li>
    <li><a href="/about/index.html">About</a></li>
    
    <li>
    <div id="dark">
        <form action="//www.google.com.hk/search" method="get" accept-charset="UTF-8" id="search">
            <input type="hidden" name="sitesearch" value="https://zhaozhiming.github.io" />
            <input type="text" name="q" results="0" placeholder="Search..." x-webkit-speech />
        </form>
    </div>
    </li>
        
</ul>




</header>


<div id="toload">
<!-- begin toload -->
    <div id="content">
        <div class="inner">
<article class="post">
	<h2 class="title">深入解析 Solana 交易</h2>
    <div class="meta">
        <div class="date">Published on: <time datetime="2025-05-23T06:02:09.000Z" itemprop="datePublished">5月 23, 2025</time>
</div>
        <div class="tags">Tags: 

<a href="/tags/solana/">solana</a> <a href="/tags/transaction/">transaction</a> <a href="/tags/solana-explorer/">solana-explorer</a> <a href="/tags/solscan/">solscan</a> <a href="/tags/solana-rpc/">solana-rpc</a>
</div>
    </div>
	<div class="entry-content"><img src="/images/post/2025/05/solana-transaction.png" class="" width="400" height="300">

<p>在区块链的世界里，交易是一切活动的核心，它记录着价值的转移、状态的变更以及智能合约的执行。对于 Solana 这样一个高性能区块链网络而言，理解交易的结构和机制显得尤为重要。与传统的区块链网络相比，Solana 的交易设计更加复杂和精巧，它不仅支持高并发处理，还提供了丰富的指令类型和灵活的账户模型。无论你是区块链开发者、数据分析师，还是对 Solana 生态感兴趣的技术爱好者，深入了解 Solana 交易的内部结构都是必不可少的技能。本文将带你全面解析 Solana 交易，从多种查看方式到详细的数据结构，从 RPC 调用到浏览器界面，帮助你掌握 Solana 交易分析的各种技巧和最佳实践。</p>
<span id="more"></span>

<h2 id="了解-Solana-交易信息的几种方式"><a href="#了解-Solana-交易信息的几种方式" class="headerlink" title="了解 Solana 交易信息的几种方式"></a>了解 Solana 交易信息的几种方式</h2><p>在 Solana 生态中，如果你想了解交易的详细信息，有多种方式可以帮助到你，以下是最常用的几种方法：</p>
<ol>
<li>Solana Explorer：最直观的图形界面方式，适合快速查看交易详情和状态</li>
<li>RPC 方法：通过编程方式获取原始交易数据，适合需要深度分析或集成到应用程序中</li>
<li>Web3.js SDK：提供更高级的 API 接口，简化交易数据的获取和处理</li>
</ol>
<p>可以根据你的需求来选择具体的方式，下面我们将详细介绍每种方式的具体使用方法。</p>
<h3 id="使用-Solana-浏览器查看交易"><a href="#使用-Solana-浏览器查看交易" class="headerlink" title="使用 Solana 浏览器查看交易"></a>使用 Solana 浏览器查看交易</h3><p><a target="_blank" rel="noopener" href="https://explorer.solana.com/">Solana Explorer</a> 是 Solana 官方提供的区块链浏览器，它提供了丰富的交易信息查看功能。通过 Solana Explorer，你可以轻松查看交易详情、账户状态、区块高度等重要信息。</p>
<p>进入 Solana Explorer 网站后，你可以在搜索框中输入交易的哈希值，回车后就可以看到交易详情。交易详情包含 <code>Overview</code> 、 <code>Account Input(s)</code> 、 <code>Token Balances</code> 、 <code>Instructions</code> 和 <code>Program Instruction Logs</code> 等几个部分。</p>
<img src="/images/post/2025/05/solana-explorer.png" class="" width="1000" height="600">

<ul>
<li>在 <code>Overview</code> 区域，你可以看到交易的基本信息，包括交易哈希、区块高度、时间戳、交易金额等。</li>
<li>在 <code>Account Input(s)</code> 区域，你可以看到交易涉及的账户信息，包括账号的地址和账户名称。</li>
<li>在 <code>Token Balances</code> 区域，你可以看到交易涉及的代币信息，包括转账代币的账号地址、代币地址、代币转账数量、交易后该账号的代币数量等。</li>
<li>在 <code>Instructions</code> 区域，你可以看到交易涉及的指令信息，包括顶层指令以及内部指令、指令的程序地址、消耗的 CU 数量、指令参数等。</li>
<li>在 <code>Program Instruction Logs</code> 区域，你可以看到交易涉及的程序指令日志信息，包括每个指令的详细日志输出内容等。</li>
</ul>
<p>除了在 Solana Explorer 网站上查看交易详情，你还可以在其他第三方的 Solana 浏览器上查看交易信息，其中比较出名的是 <a target="_blank" rel="noopener" href="https://solscan.io/">Solscan</a> 网站。</p>
<p>Solscan 作为 Solana 生态中知名的第三方浏览器，相比官方的 Solana Explorer 提供了更多特色功能，包括更丰富的代币市场数据、更强大的账户分析工具、更友好的用户界面、额外的实用功能（如交易中代币转账的可视化地图）以及更完善的开发者工具。这些功能使 Solscan 成为一个更全面的 Solana 生态工具，特别适合需要深入分析交易和账户数据的用户。</p>
<h3 id="使用-Solana-RPC-方法获取交易信息"><a href="#使用-Solana-RPC-方法获取交易信息" class="headerlink" title="使用 Solana RPC 方法获取交易信息"></a>使用 Solana RPC 方法获取交易信息</h3><p>Solana 官方提供了很多 RPC 方法， 包括 <code>HTTP</code> 和 <code>Websocket</code> 的接口，这些接口可以获取账号信息、获取区块信息、获取交易信息等，其中获取交易信息是一个 <code>HTTP</code> 接口：<a target="_blank" rel="noopener" href="https://solana.com/docs/rpc/http/gettransaction">getTransaction</a>。</p>
<p>这种方式比较适合需要深度分析交易信息的用户，比如开发者、数据分析师等。以下是一个使用 <code>curl</code> 命令获取交易信息的示例：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">curl https://api.mainnet-beta.solana.com -s -X \</span><br><span class="line">   POST -H <span class="string">&quot;Content-Type: application/json&quot;</span> -d <span class="string">&#x27;</span></span><br><span class="line"><span class="string">   &#123;</span></span><br><span class="line"><span class="string">     &quot;jsonrpc&quot;: &quot;2.0&quot;,</span></span><br><span class="line"><span class="string">     &quot;id&quot;: 1,</span></span><br><span class="line"><span class="string">     &quot;method&quot;: &quot;getTransaction&quot;,</span></span><br><span class="line"><span class="string">     &quot;params&quot;: [</span></span><br><span class="line"><span class="string">       &quot;3AnirZmjF1U64zfCUyrzWBzNGvcaa3Ya7PacAD5Y5LRoHsnZsHSekQEAKGuMCbtGNWXChPe5uWQkvipDGwfUVNAx&quot;,</span></span><br><span class="line"><span class="string">       &#123;</span></span><br><span class="line"><span class="string">         &quot;commitment&quot;: &quot;confirmed&quot;,</span></span><br><span class="line"><span class="string">         &quot;maxSupportedTransactionVersion&quot;: 0,</span></span><br><span class="line"><span class="string">         &quot;encoding&quot;: &quot;json&quot;</span></span><br><span class="line"><span class="string">       &#125;</span></span><br><span class="line"><span class="string">     ]</span></span><br><span class="line"><span class="string">   &#125;</span></span><br><span class="line"><span class="string"> &#x27;</span></span><br></pre></td></tr></table></figure>

<p><code>getTransaction</code> 方法的参数包括：</p>
<ul>
<li><code>transactionSignature</code>：交易哈希</li>
<li><code>config</code>：Object 类型的配置参数，包括以下几个参数：<ul>
<li><code>commitment</code>: 交易确认的级别，可选值包括 <code>confirmed</code> 和 <code>finalized</code>，默认值是 <code>finalized</code>。</li>
<li><code>maxSupportedTransactionVersion</code>: 最大支持的交易版本号，当前的有效值是 <code>0</code>。</li>
<li><code>encoding</code>: 交易编码格式，可选值包括 <code>json</code>、<code>base64</code>、<code>jsonParsed</code> 和 <code>base58</code>，默认值是 <code>json</code>。</li>
</ul>
</li>
</ul>
<p>返回的结果是一个 <code>JSON</code> 对象，其中包含交易信息，包括交易哈希、区块高度、时间戳、交易金额等。</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;jsonrpc&quot;</span><span class="punctuation">:</span> <span class="string">&quot;2.0&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;result&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;blockTime&quot;</span><span class="punctuation">:</span> <span class="number">1747674547</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;meta&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;computeUnitsConsumed&quot;</span><span class="punctuation">:</span> <span class="number">169182</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;err&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;fee&quot;</span><span class="punctuation">:</span> <span class="number">17621</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;innerInstructions&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span>…<span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;loadedAddresses&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span><span class="attr">&quot;readonly&quot;</span><span class="punctuation">:</span>…<span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;logMessages&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span>…<span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;postBalances&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span>…<span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;postTokenBalances&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span>…<span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;preBalances&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span>…<span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;preTokenBalances&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span>…<span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;returnData&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span><span class="attr">&quot;data&quot;</span><span class="punctuation">:</span>…<span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;rewards&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;status&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;Ok&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span></span><br><span class="line">      <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;slot&quot;</span><span class="punctuation">:</span> <span class="number">341094579</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;transaction&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span><span class="attr">&quot;message&quot;</span><span class="punctuation">:</span>…<span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;version&quot;</span><span class="punctuation">:</span> <span class="number">0</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="number">1</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<p>这些数据完全等价于我们在 Solana Explorer 中看到的交易信息，只是浏览器将这些数据进行了可视化的展示，方便我们查看，后面我们会详细介绍数据中各个字段的含义。</p>
<h3 id="使用-Solana-web3-js-NPM-包获取交易信息"><a href="#使用-Solana-web3-js-NPM-包获取交易信息" class="headerlink" title="使用 Solana@web3.js NPM 包获取交易信息"></a>使用 <code>Solana@web3.js</code> NPM 包获取交易信息</h3><p>还有一种交易查询方式方式适合开发者使用，那就是使用 <a target="_blank" rel="noopener" href="https://www.npmjs.com/package/@solana/web3.js">Solana@web3.js NPM</a> 包，这个包是 Solana 官方提供的 JavaScript 库，可以方便地获取交易信息。</p>
<p>这个包提供了两个方法来获取交易信息：<code>getTransaction</code> 和 <code>getParsedTransaction</code>，这两个方法的底层都是调用 Solana 的 RPC 方法：<code>getTransaction</code>，但返回的数据结构有所不同。</p>
<p>以下是使用 <code>Solana@web3.js</code> NPM 包获取交易信息的示例：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;</span><br><span class="line">  <span class="title class_">Connection</span>,</span><br><span class="line">  <span class="title class_">PublicKey</span>,</span><br><span class="line">  clusterApiUrl,</span><br><span class="line">  type <span class="title class_">GetVersionedTransactionConfig</span>,</span><br><span class="line">&#125; <span class="keyword">from</span> <span class="string">&quot;@solana/web3.js&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> connection = <span class="keyword">new</span> <span class="title class_">Connection</span>(<span class="title function_">clusterApiUrl</span>(<span class="string">&quot;mainnet-beta&quot;</span>), <span class="string">&quot;confirmed&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> signature =</span><br><span class="line">  <span class="string">&quot;3AnirZmjF1U64zfCUyrzWBzNGvcaa3Ya7PacAD5Y5LRoHsnZsHSekQEAKGuMCbtGNWXChPe5uWQkvipDGwfUVNAx&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> <span class="attr">config</span>: <span class="title class_">GetVersionedTransactionConfig</span> = &#123;</span><br><span class="line">  <span class="attr">commitment</span>: <span class="string">&quot;finalized&quot;</span>,</span><br><span class="line">  <span class="attr">maxSupportedTransactionVersion</span>: <span class="number">0</span>,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> transaction = <span class="keyword">await</span> connection.<span class="title function_">getTransaction</span>(signature, config);</span><br><span class="line"><span class="keyword">let</span> parsedTransaction = <span class="keyword">await</span> connection.<span class="title function_">getParsedTransaction</span>(</span><br><span class="line">  signature,</span><br><span class="line">  config</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(transaction);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(parsedTransaction);</span><br></pre></td></tr></table></figure>

<p><code>getTransaction</code> 方法返回的是一个 <code>Transaction</code> 对象，相比 <code>getParsedTransaction</code> 方法返回的对象，前者的数据量更小，传输更快，适合需要低层级访问或自定义解析逻辑的场景，对于简单的查询，处理速度可能更快。</p>
<p><code>getParsedTransaction</code> 方法返回的是一个 <code>ParsedTransaction</code> 对象，它的数据已经预先解析，更容易直接使用，提供更友好的访问格式，尤其是指令部分的数据，减少客户端的解析负担，更适合需要理解交易内容的应用程序。</p>
<p>以交易中的某个指令数据为例来说明这 2 个方法返回数据的主要不同：</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// getTransaction instruction</span></span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;programIdIndex&quot;</span><span class="punctuation">:</span> <span class="number">9</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;accountKeyIndexes&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="number">0</span><span class="punctuation">,</span> <span class="number">2</span><span class="punctuation">,</span> <span class="number">0</span><span class="punctuation">,</span> <span class="number">25</span><span class="punctuation">,</span> <span class="number">7</span><span class="punctuation">,</span> <span class="number">30</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;data&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Buffer&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;data&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="number">1</span><span class="punctuation">]</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// getParsedTransaction instruction</span></span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;parsed&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;info&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;account&quot;</span><span class="punctuation">:</span> <span class="string">&quot;7ubjuqeAFvE3yjsDNdrD31bS8Do9DHB2yGJ2b5yCCvJL&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;mint&quot;</span><span class="punctuation">:</span> <span class="string">&quot;59obFNBzyTBGowrkif5uK7ojS58vsuWz3ZCvg6tfZAGw&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;source&quot;</span><span class="punctuation">:</span> <span class="string">&quot;21w1M4yesWyzVVryHuHqg7rLUMWtp78RRaH1Zz6vhwfB&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;systemProgram&quot;</span><span class="punctuation">:</span> <span class="string">&quot;11111111111111111111111111111111&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;tokenProgram&quot;</span><span class="punctuation">:</span> <span class="string">&quot;TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;wallet&quot;</span><span class="punctuation">:</span> <span class="string">&quot;21w1M4yesWyzVVryHuHqg7rLUMWtp78RRaH1Zz6vhwfB&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;createIdempotent&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;program&quot;</span><span class="punctuation">:</span> <span class="string">&quot;spl-associated-token-account&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;programId&quot;</span><span class="punctuation">:</span> <span class="string">&quot;ATokenGPvbdGVxr1b2hvZbsiqW5xWH25efTNsLJA8knL&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;stackHeight&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<p>在 <code>getTransaction</code> 方法返回的数据中，指令数据是原始的二进制数据，程序 ID 和账号地址都是索引值，且数据是二进制格式，需要客户端自己解析，而 <code>getParsedTransaction</code> 方法返回的数据中，指令数据已经解析为人类可读的格式，包括指令的类型、参数、账户等信息，其中的 <code>parsed</code> 字段就是解析后的数据。</p>
<p>这两个方法都可以用来获取交易的信息，选择哪个方法取决于你的具体需求。如果你需要最高效的数据传输和处理，并且计划自己解析交易数据，<code>getTransaction</code>方法可能更合适。如果你需要更易用、更人类可读的数据格式，并且不想处理复杂的解析逻辑，<code>getParsedTransaction</code> 可能是更好的选择。</p>
<p>在大多数应用场景中，尤其是开发者工具、区块浏览器或需要展示交易详情的应用，<code>getParsedTransaction</code>  方法通常更有优势，因为它提供了更方便的数据访问方式，减少了客户端的解析工作量，并且能够更好地处理复杂的交易指令内容。</p>
<h2 id="交易数据结构分析"><a href="#交易数据结构分析" class="headerlink" title="交易数据结构分析"></a>交易数据结构分析</h2><p>下面我们以 <code>getParsedTransaction</code> 方法返回的数据为例，来分析交易数据结构。首先我们来看下返回的数据结构顶层的字段：</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;blockTime&quot;</span><span class="punctuation">:</span> <span class="number">1747674547</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;meta&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span><span class="attr">&quot;computeUnitsConsumed&quot;</span><span class="punctuation">:</span>…<span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;slot&quot;</span><span class="punctuation">:</span> <span class="number">341094579</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;transaction&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span><span class="attr">&quot;message&quot;</span><span class="punctuation">:</span>…<span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;version&quot;</span><span class="punctuation">:</span> <span class="number">0</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>blockTime: 交易被确认的 UNIX 时间戳（秒）。</li>
<li>meta: 包含交易执行结果的元数据，包括状态、费用、令牌余额变化等。</li>
<li>slot: 交易所在区块的槽位号，也可以理解为区块高度，Solana 区块链中用于标识区块高度的唯一标识符。</li>
<li>transaction: 包含交易详细信息的对象，如签名、指令和账户等。</li>
<li>version: 交易格式的版本号。</li>
</ul>
<h3 id="meta-字段"><a href="#meta-字段" class="headerlink" title="meta 字段"></a>meta 字段</h3><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;meta&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;computeUnitsConsumed&quot;</span><span class="punctuation">:</span> <span class="number">169182</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;err&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;fee&quot;</span><span class="punctuation">:</span> <span class="number">17621</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;innerInstructions&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span>…<span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;logMessages&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span>…<span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;postBalances&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span>…<span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;postTokenBalances&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span>…<span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;preBalances&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span>…<span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;preTokenBalances&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span>…<span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;returnData&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span><span class="attr">&quot;data&quot;</span><span class="punctuation">:</span>…<span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;rewards&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;status&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;Ok&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>computeUnitsConsumed: 交易执行消耗的计算单元数量。</li>
<li>err: 如果交易失败，这里会显示错误信息；成功则为 null。</li>
<li>fee: 交易处理费用（以 lamports 为单位，1 SOL &#x3D; 10^9 lamports）。</li>
<li>innerInstructions: 包含由其他指令触发的内部指令数组。</li>
<li>logMessages: 交易执行时程序输出的日志信息数组。</li>
<li>preBalances 和 postBalances: 交易前后账户的 lamports 余额数组。</li>
<li>preTokenBalances 和 postTokenBalances: 交易前后涉及的代币账户余额信息。</li>
<li>returnData: 交易返回的数据。</li>
<li>rewards: 交易奖励信息。</li>
<li>status: 交易状态对象，通常成功会显示为 {“Ok”: null}。</li>
</ul>
<p><code>innerInstructions</code> 字段是一个数组，每个元素是一个内部指令对象，内部指令对象包含以下字段：</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">&quot;innerInstructions&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">  <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;index&quot;</span><span class="punctuation">:</span> <span class="number">2</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;instructions&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">      <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;parsed&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">          <span class="attr">&quot;info&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;extensionTypes&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">              <span class="string">&quot;immutableOwner&quot;</span></span><br><span class="line">            <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;mint&quot;</span><span class="punctuation">:</span> <span class="string">&quot;59obFNBzyTBGowrkif5uK7ojS58vsuWz3ZCvg6tfZAGw&quot;</span></span><br><span class="line">          <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">          <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;getAccountDataSize&quot;</span></span><br><span class="line">        <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;program&quot;</span><span class="punctuation">:</span> <span class="string">&quot;spl-token&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;programId&quot;</span><span class="punctuation">:</span> <span class="string">&quot;TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;stackHeight&quot;</span><span class="punctuation">:</span> <span class="number">2</span></span><br><span class="line">      <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="comment">// ......</span></span><br><span class="line">    <span class="punctuation">]</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">]</span></span><br></pre></td></tr></table></figure>

<ul>
<li>index: 对应顶层指令的索引</li>
<li>instructions: 内部指令列表，包含程序 ID 和指令数据，指令数据已经解析为人类可读的格式，包括指令的程序名称、程序 ID、指令参数等。</li>
</ul>
<p><code>preBalances</code> 和 <code>postBalances</code> 字段的数据类型是数组，是所有参与交易的账户的原生 SOL 余额（以 lamports 为单位），数组的索引位置与 <code>transaction.message.accountKeys</code>（后面会介绍）中的账户位置一一对应。</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">&quot;postBalances&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">  <span class="number">493860324</span><span class="punctuation">,</span></span><br><span class="line">  <span class="number">2039280</span><span class="punctuation">,</span></span><br><span class="line">  <span class="number">2039280</span><span class="punctuation">,</span></span><br><span class="line">  <span class="comment">// ......</span></span><br><span class="line"><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line"><span class="attr">&quot;postBalances&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">  <span class="number">495917225</span><span class="punctuation">,</span></span><br><span class="line">  <span class="number">2039280</span><span class="punctuation">,</span></span><br><span class="line">  <span class="number">0</span><span class="punctuation">,</span></span><br><span class="line">  <span class="comment">// ......</span></span><br><span class="line"><span class="punctuation">]</span></span><br></pre></td></tr></table></figure>

<p><code>preTokenBalances</code> 和 <code>postTokenBalances</code> 这 2 个数组字段只包含该交易中涉及代币变动的账户的代币余额信息，而不是所有账户。每个元素都包含 <code>accountIndex</code> 字段，指向 <code>accountKeys</code> 中的索引位置。</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">&quot;postTokenBalances&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">  <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;accountIndex&quot;</span><span class="punctuation">:</span> <span class="number">1</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;mint&quot;</span><span class="punctuation">:</span> <span class="string">&quot;59obFNBzyTBGowrkif5uK7ojS58vsuWz3ZCvg6tfZAGw&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;owner&quot;</span><span class="punctuation">:</span> <span class="string">&quot;3CgvbiM3op4vjrrjH2zcrQUwsqh5veNVRjFCB9N6sRoD&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;programId&quot;</span><span class="punctuation">:</span> <span class="string">&quot;TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;uiTokenAmount&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;amount&quot;</span><span class="punctuation">:</span> <span class="string">&quot;8802868&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;decimals&quot;</span><span class="punctuation">:</span> <span class="number">6</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;uiAmount&quot;</span><span class="punctuation">:</span> <span class="number">8.802868</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;uiAmountString&quot;</span><span class="punctuation">:</span> <span class="string">&quot;8.802868&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="comment">// ......</span></span><br><span class="line"><span class="punctuation">]</span></span><br><span class="line"><span class="attr">&quot;preTokenBalances&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">  <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;accountIndex&quot;</span><span class="punctuation">:</span> <span class="number">1</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;mint&quot;</span><span class="punctuation">:</span> <span class="string">&quot;59obFNBzyTBGowrkif5uK7ojS58vsuWz3ZCvg6tfZAGw&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;owner&quot;</span><span class="punctuation">:</span> <span class="string">&quot;3CgvbiM3op4vjrrjH2zcrQUwsqh5veNVRjFCB9N6sRoD&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;programId&quot;</span><span class="punctuation">:</span> <span class="string">&quot;TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;uiTokenAmount&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;amount&quot;</span><span class="punctuation">:</span> <span class="string">&quot;8506130&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;decimals&quot;</span><span class="punctuation">:</span> <span class="number">6</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;uiAmount&quot;</span><span class="punctuation">:</span> <span class="number">8.50613</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;uiAmountString&quot;</span><span class="punctuation">:</span> <span class="string">&quot;8.50613&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="comment">// ......</span></span><br><span class="line"><span class="punctuation">]</span></span><br></pre></td></tr></table></figure>

<p>代币余额信息包括：</p>
<ul>
<li>accountIndex: 对应 <code>accountKeys</code> 中的索引</li>
<li>mint: 代币铸造地址</li>
<li>owner: 代币账户所有者</li>
<li>uiTokenAmount: 代币数量信息（包括数量、精度和 UI 显示数量）</li>
</ul>
<p><code>logMessages</code> 字段是交易执行时程序输出的日志信息数组，每个元素是一行日志信息：</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">&quot;logMessages&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">  <span class="string">&quot;Program ComputeBudget111111111111111111111111111111 invoke [1]&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="string">&quot;Program ComputeBudget111111111111111111111111111111 success&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="string">&quot;Program ComputeBudget111111111111111111111111111111 invoke [1]&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="comment">// ......</span></span><br><span class="line"><span class="punctuation">]</span></span><br></pre></td></tr></table></figure>

<p><code>rewards</code> 字段主要用于记录与区块验证和共识机制相关的奖励信息，是 Solana 经济模型的一个重要组成部分。对普通用户分析交易时，该字段通常不是重点关注内容，但对理解 Solana 的经济模型和奖励机制非常重要。</p>
<p><code>returnData</code> 字段是 Solana 程序向调用者返回数据的机制，允许程序在执行完成后传递结果数据。这个机制为 Solana 生态系统中的程序间通信提供了标准化的数据返回方式，特别在复杂的 DeFi 操作中非常有用。</p>
<h3 id="transaction-字段"><a href="#transaction-字段" class="headerlink" title="transaction 字段"></a>transaction 字段</h3><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">&quot;transaction&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;message&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;accountKeys&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span>…<span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;addressTableLookups&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span>…<span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;instructions&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span>…<span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;recentBlockhash&quot;</span><span class="punctuation">:</span> <span class="string">&quot;64DTRb3pnTsxvjNEnVLEpqwdoyFc388ydcf7EyMdcbTm&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;signatures&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">    <span class="string">&quot;3AnirZmjF1U64zfCUyrzWBzNGvcaa3Ya7PacAD5Y5LRoHsnZsHSekQEAKGuMCbtGNWXChPe5uWQkvipDGwfUVNAx&quot;</span></span><br><span class="line">  <span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>message: 包含交易消息的对象。<ul>
<li>accountKeys: 参与交易的账户列表。</li>
<li>addressTableLookups: 地址查找表相关信息。</li>
<li>instructions: 交易包含的指令数组。</li>
<li>recentBlockhash: 交易使用的最近区块哈希。</li>
</ul>
</li>
<li>signatures: 交易签名数组，第一个通常是交易 ID。</li>
</ul>
<p><code>accountKeys</code> 字段是参与交易的账户列表，每个元素是一个账户对象，之前的 <code>meta</code> 字段中很多属性都与该字段有关联，包含以下信息：</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">&quot;accountKeys&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">  <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;pubkey&quot;</span><span class="punctuation">:</span> <span class="string">&quot;21w1M4yesWyzVVryHuHqg7rLUMWtp78RRaH1Zz6vhwfB&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;signer&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;source&quot;</span><span class="punctuation">:</span> <span class="string">&quot;transaction&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;writable&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="comment">// ......</span></span><br><span class="line"><span class="punctuation">]</span></span><br></pre></td></tr></table></figure>

<ul>
<li>pubkey: 账户公钥</li>
<li>signer: 是否为交易签名者</li>
<li>source: 账户来源（transaction 或 lookupTable）</li>
<li>writable: 是否可写</li>
</ul>
<p><code>addressTableLookups</code> 是 Solana 交易中的一个关键字段，主要用于解决交易账户数量限制问题，Solana 交易默认最多可包含 32 个直接账户引用，通过地址查找表可以引用更多账户，这样就突破账户数量限制。另外一个作用是减小交易大小，避免在交易中重复包含完整的 32 字节账户地址，仅包含查找表地址和索引，大幅减少交易数据体积。它的工作原理是事先在链上创建地址查找表（Address Lookup Table），该表存储多个常用账户地址，每个地址分配一个索引，交易中通过指定查找表地址和索引来引用账户，不需要包含完整的账户地址。</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">&quot;addressTableLookups&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">  <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;accountKey&quot;</span><span class="punctuation">:</span> <span class="string">&quot;6dfGWWq4sTPFHPvnVBZNjQd2PTqzgGAexLAHXao7TRSb&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;readonlyIndexes&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">      <span class="number">17</span></span><br><span class="line">    <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;writableIndexes&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">      <span class="number">18</span><span class="punctuation">,</span></span><br><span class="line">      <span class="number">12</span><span class="punctuation">,</span></span><br><span class="line">      <span class="number">10</span><span class="punctuation">,</span></span><br><span class="line">      <span class="number">19</span><span class="punctuation">,</span></span><br><span class="line">      <span class="number">15</span></span><br><span class="line">    <span class="punctuation">]</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="comment">// ......</span></span><br><span class="line"><span class="punctuation">]</span></span><br></pre></td></tr></table></figure>

<p><code>addressTableLookups</code> 字段中各字段含义：</p>
<ul>
<li>accountKey：地址查找表的公钥地址</li>
<li>readonlyIndexes：从查找表引用的只读账户索引</li>
<li>writableIndexes：从查找表引用的可写账户索引</li>
</ul>
<p>在交易时，交易处理器会找到 <code>accountKey</code> 指定的地址查找表，查找表中检索指定索引位置的账户地址，将这些地址添加到交易的账户列表中，根据是在 <code>readonlyIndexes</code> 还是 <code>writableIndexes</code> 中标记账户权限，这就是为什么在 <code>accountKeys</code> 数组中，有些账户的 <code>source</code> 值为 <code>lookupTable</code>，表明它们是通过地址查找表加载的，而不是直接包含在交易中。</p>
<p><code>transaction.message.instructions</code> 字段是交易包含的顶层指令数组，每个元素是一个顶层指令对象，顶层指令与 <code>meta</code> 字段中的 <code>innerInstructions</code> 内部指令的区别是：</p>
<ul>
<li>顶层指令是用户&#x2F;客户端显式包含在交易中的指令，在交易创建和签名时直接指定，代表交易的主要意图和行为，由交易者直接控制和构建，在交易提交时已确定，数量通常有限，按数组顺序执行，相当于程序的主函数或入口点，是触发后续一系列操作的起点。</li>
<li>内部指令是顶层指令执行过程中动态生成的派生指令，不在原始交易中显式指定，是程序执行逻辑的细节体现，当一个程序调用另一个程序（CPI）时产生，每组内部指令通过 <code>index</code> 字段关联到生成它的顶层指令，一个顶层指令可能生成多个内部指令，内部指令可能进一步产生更深层次的内部指令，形成指令调用树结构。</li>
</ul>
<p>我们可以在这些指令对象中看到 <code>stackHeight</code> 字段，该字段是指令在程序调用栈中的深度级别，反映了指令之间的调用层级关系，值为 <code>null</code> 通常表示顶层指令，值为 <code>1</code> 表示由顶层程序直接调用的指令，值为 <code>2</code> 表示由 <code>stackHeight</code> 为 <code>1</code> 的程序调用的指令，值为 <code>3+</code> 表示更深层次的嵌套调用。</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">&quot;transaction&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;message&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;instructions&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">      <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;accounts&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;data&quot;</span><span class="punctuation">:</span> <span class="string">&quot;EC5es9&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;programId&quot;</span><span class="punctuation">:</span> <span class="string">&quot;ComputeBudget111111111111111111111111111111&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;stackHeight&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span></span><br><span class="line">      <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="comment">// ......</span></span><br><span class="line">    <span class="punctuation">]</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>本文从实用角度出发，全面解析了 Solana 交易的查看方式和数据结构。无论你是通过浏览器快速查看交易详情，还是使用 RPC 接口进行深度分析，或是利用 Web3.js SDK 构建应用程序，都能在本文中找到最适合的方法和最佳实践。通过深入理解交易的 meta 和 transaction 字段、指令层级关系以及地址查找表等核心概念，你将具备分析任何 Solana 交易的能力。这些知识不仅是 Solana 开发的基础技能，更是在这个高性能区块链生态中构建优秀应用的必备工具。掌握了这些，你就拥有了解读 Solana 链上世界的钥匙。</p>
<h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><ul>
<li><a target="_blank" rel="noopener" href="https://solana.com/docs/core/transactions">交易和指令</a></li>
<li><a target="_blank" rel="noopener" href="https://docs.solscan.io/transaction-details/transaction-details">Solscan 交易详情</a></li>
<li><a target="_blank" rel="noopener" href="https://info.solscan.io/exploring-account-page/">Solscan 账号页面</a></li>
<li><a target="_blank" rel="noopener" href="https://solana.com/docs/rpc">Solana RPC 接口文档</a></li>
</ul>
<p>关注我，一起学习各种最新的 AI 和编程开发技术，欢迎交流，如果你有什么想问想说的，欢迎在评论区留言。</p>
</div>

</article>
<section id="appreciates">
  <center>
	<h2>赞赏</h2>
    <div class="post-footer">
      <div>
	    <h4>如果文章对您有所帮助，可以捐赠我喝杯咖啡😌，捐赠方式：</h4>
        <div class="digital-wallet">
          <h6>BTC 地址：3LYgSyf7ddMALwGWPQr3PY4wzjsTDdg1oV</h6>
          <h6>ETH 地址：0x0C9b27c89A61aadb0aEC24CA8949910Cbf77Aa73</h6>
        </div>
        <div class="wechat_appreciates">
          <img src="/images/wechat_appreciates.png" alt="qrcode" width="250" >
        </div>
      </div>
      <div>
	    <h4>文章已同步更新公众号，欢迎关注</h4>
        <div class="wechat_appreciates">
          <img src="/images/wxgzh_qrcode.jpg" alt="qrcode" width="250" >
        </div>
      </div>
    </div>
  </center>
</section>



    
      <script type="text/javascript">
        var disqus_config = function () {
            this.page.url = 'https://zhaozhiming.github.io/2025/05/23/deep-dive-into-solana-transaction/';
            this.page.identifier = 'https://zhaozhiming.github.io/2025/05/23/deep-dive-into-solana-transaction/';
        };

        (function() {
          var d = document, s = d.createElement('script');
          s.src = '//zhaozhiming.disqus.com/embed.js';
          s.setAttribute('data-timestamp', +new Date());
          (d.head || d.body).appendChild(s);
        })();
      </script>
    



<section id="comment">
    <h2 class="title">Comments</h2>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a target="_blank" rel="noopener" href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
</section>

</div>

    </div>
    <footer id="footer">
    <div style="display:inline">
    Copyright &copy; 2025

    赵芝明
. Powered by <a href="http://zespia.tw/hexo/" target="_blank">Hexo</a> |
    Theme is <a target="_blank" rel="noopener" href="https://github.com/wd/hexo-fabric">hexo-fabric</a>, fork from <a target="_blank" rel="noopener" href="http://github.com/panks/fabric">fabric</a> by <a target="_blank" rel="noopener" href="http://panks.me">Pankaj Kumar</a>
</div>


    </footer>
    <script src="/javascripts/fabric.js"></script>
<script src="/javascripts/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
	$('.fancybox').fancybox();
})(jQuery);
</script>
 <!-- Delete or comment this line to disable Fancybox -->



<!-- end toload --> 
</div>
</div>
<script src="/javascripts/jquery.ui.totop.js" type="text/javascript"></script>
<script type="text/javascript">
/*<![CDATA[*/
;(function($){$().UItoTop({easingType:'easeOutCirc'});})(jQuery); 
/*]]>*/
</script><!-- remove it to remove the scroll to top button -->
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5608723650603289" crossorigin="anonymous"></script>
</body>
</html>
